<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</title>
<meta name="author" content="Nicolas Saby, INRAe Infosol, Orléans France">
<meta name="description" content="7.1 Caractéristiques Lorsque les paramètres de la population (moyenne ou total, percentiles) à étudier ou pour plusieurs sous-régions n’est pas suffisant La résolution spatiale requise pour la...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols">
<meta property="og:type" content="book">
<meta property="og:description" content="7.1 Caractéristiques Lorsque les paramètres de la population (moyenne ou total, percentiles) à étudier ou pour plusieurs sous-régions n’est pas suffisant La résolution spatiale requise pour la...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols">
<meta name="twitter:description" content="7.1 Caractéristiques Lorsque les paramètres de la population (moyenne ou total, percentiles) à étudier ou pour plusieurs sous-régions n’est pas suffisant La résolution spatiale requise pour la...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Avant propos</a></li>
<li><a class="" href="WHY.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="data.html"><span class="header-section-number">3</span> Données</a></li>
<li><a class="" href="SI.html"><span class="header-section-number">4</span> Echantillonnage aléatoire simple</a></li>
<li><a class="" href="l%C3%A9chantillonnage-al%C3%A9atoire-stratifi%C3%A9.html"><span class="header-section-number">5</span> L’échantillonnage aléatoire stratifié</a></li>
<li><a class="" href="SY-QUICK.html"><span class="header-section-number">6</span> Echantillonnage aléatoire systématique</a></li>
<li><a class="active" href="CARTO.html"><span class="header-section-number">7</span> Echantillonnage pour la cartographie</a></li>
<li><a class="" href="Script.html"><span class="header-section-number">8</span> Script final</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="CARTO" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Echantillonnage pour la cartographie<a class="anchor" aria-label="anchor" href="#CARTO"><i class="fas fa-link"></i></a>
</h1>
<div id="caractéristiques" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Caractéristiques<a class="anchor" aria-label="anchor" href="#caract%C3%A9ristiques"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Lorsque les paramètres de la population (moyenne ou total, percentiles) à étudier ou pour plusieurs sous-régions n’est pas suffisant</p></li>
<li><p>La résolution spatiale requise pour la cartographie est bien plus importante que pour les statistique globale</p></li>
<li>
<p>Quelles Méthodes de cartographie :</p>
<ul>
<li>Méthodes d’interpolation spatiale heuristique : Polygones de Thiessen, triangulation, voisin naturel, distance inverse</li>
<li>Interpolation spatiale basée sur un modèle stochastique : le krigeage</li>
<li>Modèle non spatial : modèle de régression linéaire, arbre de régression, forêt aléatoire</li>
</ul>
</li>
</ul>
</div>
<div id="différents-types-de-plans" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Différents types de plans<a class="anchor" aria-label="anchor" href="#diff%C3%A9rents-types-de-plans"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p>Échantillonnage pour la cartographie par interpolation spatiale</p>
<ul>
<li>Plans d’échantillonnage géométriques</li>
<li>Grilles régulières</li>
<li>Échantillonnage de la couverture spatiale</li>
<li>Plans d’échantillonnage basés sur des modèles</li>
</ul>
</li>
<li>
<p>Échantillonnage pour la cartographie avec des modèles de régression ou par arbres de régression</p>
<ul>
<li>stratification de l’espace des covariables</li>
<li>Échantillonnage par hypercube latin</li>
</ul>
</li>
</ul>
</div>
<div id="la-grille-systématique" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> La grille systématique<a class="anchor" aria-label="anchor" href="#la-grille-syst%C3%A9matique"><i class="fas fa-link"></i></a>
</h2>
<div id="caractéristiques-1" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Caractéristiques<a class="anchor" aria-label="anchor" href="#caract%C3%A9ristiques-1"><i class="fas fa-link"></i></a>
</h3>
<p>Facile à mettre en œuvre</p>
<ul>
<li>Bonne couverture spatiale</li>
<li>La grille ne doit pas être forcément placée au hasard</li>
<li>Formes : carrées, triangulaires, hexagonales</li>
</ul>
<p>Pour choisir la résolution</p>
<ul>
<li>Le maximum de budget mobilisable</li>
<li>Un seuil pour l’erreur d’interpolation mais dans ce cas, il est nécessaire de poser des hypothèses sur un modèle de variabilité spatiale</li>
</ul>
<p>Avec un échantillonnage par grille régulière, la répartition des observations est fixe (carré, triangulaire)</p>
<ul>
<li><p>Avec des zones de forme irrégulière, la couverture spatiale est dans la plupart des cas sous-optimal. Elle amène souvent à des problème aux bordures en augmentant ainsi les effets de bords</p></li>
<li><p>Une couverture spatiale sous-optimale devient plus problématique lorsque nous disposons de données existantes (données anciennes)</p></li>
<li><p>En présence de données existantes, nous voulons remplir les espaces vides</p></li>
</ul>
</div>
<div id="implémentation-1" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Implémentation<a class="anchor" aria-label="anchor" href="#impl%C3%A9mentation-1"><i class="fas fa-link"></i></a>
</h3>
<p>On teste ici les fonctions en prenant la parcelle du package <code>spcosa</code></p>
<p>Voici l’exemple pour la grille de type régulière à maille carrée. On remarque la présence de zone sans donnée.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regular</span></span>
<span><span class="va">MagrilleReg</span> <span class="op">&lt;-</span> <span class="fu">st_sample</span><span class="op">(</span> <span class="va">shpFarmsum.sf</span> ,</span>
<span>                    type <span class="op">=</span> <span class="st">"regular"</span>,</span>
<span>                    <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">shpFarmsum</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">MagrilleReg</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_symbols</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Grilleregfig"></span>
<img src="cours-echantillonnage_files/figure-html/Grilleregfig-1.png" alt="Grille régulière" width="110%"><p class="caption">
Figure 7.1: Grille régulière
</p>
</div>
<p>Voici l’exemple pour la grille de type régulière carré. On remarque la présence de zone sans donnée.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MagrilleHex</span> <span class="op">&lt;-</span> <span class="fu">st_sample</span><span class="op">(</span> <span class="va">shpFarmsum.sf</span> ,</span>
<span>                    type <span class="op">=</span> <span class="st">"hexagonal"</span>,</span>
<span>                    <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">shpFarmsum</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">MagrilleHex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_symbols</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GrillerHexfig"></span>
<img src="cours-echantillonnage_files/figure-html/GrillerHexfig-1.png" alt="Echantillonnage optimisé pour le krigeage" width="110%"><p class="caption">
Figure 7.2: Echantillonnage optimisé pour le krigeage
</p>
</div>
</div>
</div>
<div id="echantillonnage-spatial-optimisé" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Echantillonnage spatial optimisé<a class="anchor" aria-label="anchor" href="#echantillonnage-spatial-optimis%C3%A9"><i class="fas fa-link"></i></a>
</h2>
<div id="définition-4" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> Définition<a class="anchor" aria-label="anchor" href="#d%C3%A9finition-4"><i class="fas fa-link"></i></a>
</h3>
<p>Dans cette approche, les <span class="math inline">\(n\)</span> observations sont réparties de manière optimale au sein de la zone d’étude. Pour cela, on utilise un critère qui minimise la distance entre les observations et les points de la grille régulière de prédiction.
La moyenne du carré de la plus courte distance au point j:</p>
<p><span class="math inline">\(MCPCD_j = 1/N \sum^N_{i=1}min_j(D_{ij}^2)\)</span></p>
<p>Le critère <span class="math inline">\(MCPCD_j\)</span> peut être minimisé en utilisant l’algorithme des K-moyenne</p>
<p>Il existe un package R <code>spcosa</code> de <span class="citation">Walvoort, Brus, and Gruijter (<a href="references.html#ref-walvoort_r_2010">2010</a>)</span>.</p>
<p>Dans cette approche, il n’est pas nécessaire de définir un variogramme a priori pour l’optimisation de la répartition des <span class="math inline">\(n\)</span> observations. Les strates ainsi définies sont appelées <strong>Strates compactes</strong></p>
</div>
<div id="mise-en-oeuvre-avec-spcosa" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Mise en oeuvre avec <code>spcosa</code><a class="anchor" aria-label="anchor" href="#mise-en-oeuvre-avec-spcosa"><i class="fas fa-link"></i></a>
</h3>
<p>La fonction <code>stratify</code> implémente la stratification dite par strate compacte.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialize pseudo random number generator</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">700124</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stratify Farmsum into 50 strata</span></span>
<span><span class="va">myStratification</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span><span class="va">shpFarmsum</span>, nStrata <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot stratification</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">myStratification</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-36-1.png" width="100%"></div>
<p>Sans option, la commande spcosa::spsample extrait le centroïde des strates obtenues par l’algorithme des K-moyennes.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sans option, la commande spcosa::spsample extrait le centroïde de la strate.</span></span>
<span><span class="va">mySamplingPattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/spsample.html">spsample</a></span><span class="op">(</span><span class="va">myStratification</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot sampling pattern</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">myStratification</span>, <span class="va">mySamplingPattern</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-37-1.png" width="100%"></div>
</div>
<div id="en-présence-de-données-existantes" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> En présence de données existantes<a class="anchor" aria-label="anchor" href="#en-pr%C3%A9sence-de-donn%C3%A9es-existantes"><i class="fas fa-link"></i></a>
</h3>
<p>Supposons l’existance d’un <span class="math inline">\(k\)</span> échantillons sur la zone</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span><span class="op">=</span> <span class="fl">30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MonEchAncien</span> <span class="op">&lt;-</span> <span class="fu">st_sample</span><span class="op">(</span> <span class="va">shpFarmsum.sf</span> ,</span>
<span>                    type <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>                    <span class="va">k</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">shpFarmsum.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">MonEchAncien</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tm_dots</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"red"</span> , shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-38-1.png" width="100%"></div>
<p>La commande <code><a href="https://rdrr.io/pkg/spcosa/man/stratify-methods.html">spcosa::stratify</a></code> permet de construire les strates compactes en tenant compte de ces observations afin d’optimiser la répartition des échantillons supplémentaires pour la cartographie</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Set number of new sampling locations to be selected</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">130</span></span>
<span></span>
<span><span class="co">#Compute total sample size (existing points + new points)</span></span>
<span><span class="va">ntot</span><span class="op">&lt;-</span><span class="va">n</span><span class="op">+</span><span class="va">k</span></span>
<span><span class="co">#Compute geostrata with option priorPoints=priordataEthiopia</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">314</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MonEchAncien.sp</span>  <span class="op">&lt;-</span> <span class="fu">as_Spatial</span><span class="op">(</span><span class="va">MonEchAncien</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">myStrata</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span><span class="va">shpFarmsum</span>, </span>
<span>                     cellSize<span class="op">=</span> <span class="fl">2</span> ,</span>
<span>                     nStrata <span class="op">=</span> <span class="va">ntot</span>,</span>
<span>                     priorPoints<span class="op">=</span><span class="va">MonEchAncien.sp</span>,</span>
<span>                     nTry<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#Select sampling points of infill sample (centres of geostrata)</span></span>
<span><span class="va">mySample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/spsample.html">spsample</a></span><span class="op">(</span><span class="va">myStrata</span><span class="op">)</span></span></code></pre></div>
<p>Voici la répartition des points.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot geostrata and sampling points (centres of geostrata)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">myStrata</span>, <span class="va">mySample</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-40-1.png" width="100%"></div>
</div>
</div>
<div id="echantillonnage-pour-la-géostatitique" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Echantillonnage pour la géostatitique<a class="anchor" aria-label="anchor" href="#echantillonnage-pour-la-g%C3%A9ostatitique"><i class="fas fa-link"></i></a>
</h2>
<p>Dans une récente étude, <span class="citation">Wadoux, Marchant, and Lark (<a href="references.html#ref-wadoux_efficient_2019">2019</a>)</span> propose de rajouter 10 % du nombre total d’observations au plan par couverture spatiale optimisée. Ces points sont positionné à une petite distance de cette sélection au hasard de points.</p>
<p>On définit premièremement la distance <span class="math inline">\(d\)</span> (20 m dans cette exemple) et le nombre de points <span class="math inline">\(m\)</span> (10 %)</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySCsample.df</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">mySamplingPattern</span>, <span class="st">"data.frame"</span><span class="op">)</span> <span class="co"># on extrait ici les coordonnées</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># Distance</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="fl">0.1</span>  <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mySCsample.df</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span></code></pre></div>
<p>On tire ensuite au hasard les <span class="math inline">\(m\)</span> points et on calcule les nouvelles coordonnées afin de placer au hasard le nouveau points sur un cercle de rayon <span class="math inline">\(d\)</span>.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify separation distances and subsample sizes</span></span>
<span></span>
<span><span class="co"># Select random subsample from the spatial coverage sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">314</span><span class="op">)</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mySCsample.df</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">mySubsample</span> <span class="op">&lt;-</span> <span class="va">mySCsample.df</span><span class="op">[</span><span class="va">ids</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Select locations in random direction at distances h from subsample</span></span>
<span></span>
<span><span class="va">plus</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span>  <span class="va">dxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="va">m</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">angle</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">m</span>,</span>
<span>               min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span></span>
<span>               <span class="op">)</span></span>
<span>  <span class="va">dxy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">h</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">angle</span><span class="op">)</span></span>
<span>  <span class="va">dxy</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">h</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">angle</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">plus.h</span><span class="op">&lt;-</span><span class="va">mySubsample</span><span class="op">+</span><span class="va">dxy</span></span>
<span>  </span>
<span><span class="va">mySCsample.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">mySCsample.df</span>,<span class="va">plus.h</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mySCsample.df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">mySCsample.df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mySCsample.sf</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">mySCsample.df</span> , </span>
<span>                          coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span> , <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Voici la représentation du plan d’échantillonnage pour la géostatistique.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">shpFarmsum</span><span class="op">)</span><span class="op">+</span> <span class="fu">tm_borders</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">mySCsample.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu">tm_symbols</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PlusSample"></span>
<img src="cours-echantillonnage_files/figure-html/PlusSample-1.png" alt="Plan optimisé pour la géostatistique" width="110%"><p class="caption">
Figure 7.3: Plan optimisé pour la géostatistique
</p>
</div>
</div>
<div id="plan-optimisé-dans-lespace-des-covariables" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Plan optimisé dans l’espace des covariables<a class="anchor" aria-label="anchor" href="#plan-optimis%C3%A9-dans-lespace-des-covariables"><i class="fas fa-link"></i></a>
</h2>
<div id="définition-5" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> Définition<a class="anchor" aria-label="anchor" href="#d%C3%A9finition-5"><i class="fas fa-link"></i></a>
</h3>
<p>Dans cette partie, l’échantillons doit permettre de calibrer un modèle de regression avec des covariables spatialisées. Il existe de nombreuse méthodes pour sélectionner des unités d’échantillonnage de sorte qu’elle permette d</p>
<ul>
<li>cLHS</li>
<li>Surface response design</li>
<li>kmeans</li>
</ul>
</div>
<div id="données" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> Données<a class="anchor" aria-label="anchor" href="#donn%C3%A9es"><i class="fas fa-link"></i></a>
</h3>
<p>Comme présenté dans le chapitre sur les données, nous utilisons un jeu de données constitué de grille décrivant un ensemble de caractéristiques d’une parcelle en Australie.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tm_shape</span><span class="op">(</span> <span class="fu">rast</span><span class="op">(</span><span class="va">grdHunterValley2</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_raster</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"elevation_m"</span>,<span class="st">"slope_deg"</span>,<span class="st">"cti"</span>,<span class="st">"ndvi"</span><span class="op">)</span></span>
<span>            <span class="op">)</span>  <span class="op">+</span></span>
<span><span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-43-1.png" width="100%"></div>
</div>
<div id="mise-en-oeuvre-avec-lalgorithme-k-moyennes" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> Mise en oeuvre avec l’algorithme K-moyennes<a class="anchor" aria-label="anchor" href="#mise-en-oeuvre-avec-lalgorithme-k-moyennes"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Choisir le nombre de sites d'échantillonnage</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">20</span></span>
<span></span>
<span><span class="co">#Calcul des clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">314</span><span class="op">)</span></span>
<span><span class="va">myClusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">grdHunterValley</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                     centers<span class="op">=</span><span class="va">n</span>, </span>
<span>                     iter.max<span class="op">=</span><span class="fl">100</span>,</span>
<span>                     nstart<span class="op">=</span><span class="fl">10</span></span>
<span>                     <span class="op">)</span></span>
<span></span>
<span><span class="va">grdHunterValley</span><span class="op">$</span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="va">myClusters</span><span class="op">$</span><span class="va">cluster</span></span>
<span></span>
<span><span class="co">#Sélectionner les emplacements les plus proches des centres des clusters</span></span>
<span><span class="va">rdist.out</span> <span class="op">&lt;-</span> <span class="fu">rdist</span><span class="op">(</span>x1<span class="op">=</span><span class="va">myClusters</span><span class="op">$</span><span class="va">centers</span>,</span>
<span>                   x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">grdHunterValley</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">ids.mindist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">rdist.out</span>,MARGIN<span class="op">=</span><span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span></span>
<span><span class="va">mySample</span> <span class="op">&lt;-</span> <span class="va">grdHunterValley</span><span class="op">[</span><span class="va">ids.mindist</span>,<span class="op">]</span></span></code></pre></div>
<p>Il est possible de représenter les unités d’échantillonnage dans l’espace géographique:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">grdHunterValley</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_tile</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Easting</span>, </span>
<span>                          y <span class="op">=</span> <span class="va">Northing</span>, </span>
<span>                          fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu">scale_fill_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data<span class="op">=</span><span class="va">mySample</span>,</span>
<span>             mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Easting</span>,y<span class="op">=</span><span class="va">Northing</span><span class="op">)</span>,</span>
<span>             size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:KMsample"></span>
<img src="cours-echantillonnage_files/figure-html/KMsample-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace géographique" width="110%"><p class="caption">
Figure 7.4: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace géographique
</p>
</div>
<p>Mais également dans l’espace des covariables. Ici, on retient l’altitude et le CTI.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">grdHunterValley</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">elevation_m</span>,</span>
<span>                         x<span class="op">=</span><span class="va">cti</span>,</span>
<span>                         colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">.51</span></span>
<span>             <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data<span class="op">=</span><span class="va">mySample</span>,</span>
<span>             mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">elevation_m</span>,x<span class="op">=</span><span class="va">cti</span><span class="op">)</span>,</span>
<span>             size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Elevation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"ndvi"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:KMSample2"></span>
<img src="cours-echantillonnage_files/figure-html/KMSample2-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace des covariables" width="110%"><p class="caption">
Figure 7.5: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace des covariables
</p>
</div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">grdHunterValley</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">elevation_m</span>,</span>
<span>                         x<span class="op">=</span><span class="va">slope_deg</span>,</span>
<span>                         colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">.51</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data<span class="op">=</span><span class="va">mySample</span>,</span>
<span>             mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">elevation_m</span>,x<span class="op">=</span><span class="va">cti</span><span class="op">)</span>,</span>
<span>             size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Elevation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Slope"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:KMSample3"></span>
<img src="cours-echantillonnage_files/figure-html/KMSample3-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace des covariables" width="110%"><p class="caption">
Figure 7.6: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace des covariables
</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="SY-QUICK.html"><span class="header-section-number">6</span> Echantillonnage aléatoire systématique</a></div>
<div class="next"><a href="Script.html"><span class="header-section-number">8</span> Script final</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#CARTO"><span class="header-section-number">7</span> Echantillonnage pour la cartographie</a></li>
<li><a class="nav-link" href="#caract%C3%A9ristiques"><span class="header-section-number">7.1</span> Caractéristiques</a></li>
<li><a class="nav-link" href="#diff%C3%A9rents-types-de-plans"><span class="header-section-number">7.2</span> Différents types de plans</a></li>
<li>
<a class="nav-link" href="#la-grille-syst%C3%A9matique"><span class="header-section-number">7.3</span> La grille systématique</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#caract%C3%A9ristiques-1"><span class="header-section-number">7.3.1</span> Caractéristiques</a></li>
<li><a class="nav-link" href="#impl%C3%A9mentation-1"><span class="header-section-number">7.3.2</span> Implémentation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#echantillonnage-spatial-optimis%C3%A9"><span class="header-section-number">7.4</span> Echantillonnage spatial optimisé</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#d%C3%A9finition-4"><span class="header-section-number">7.4.1</span> Définition</a></li>
<li><a class="nav-link" href="#mise-en-oeuvre-avec-spcosa"><span class="header-section-number">7.4.2</span> Mise en oeuvre avec spcosa</a></li>
<li><a class="nav-link" href="#en-pr%C3%A9sence-de-donn%C3%A9es-existantes"><span class="header-section-number">7.4.3</span> En présence de données existantes</a></li>
</ul>
</li>
<li><a class="nav-link" href="#echantillonnage-pour-la-g%C3%A9ostatitique"><span class="header-section-number">7.5</span> Echantillonnage pour la géostatitique</a></li>
<li>
<a class="nav-link" href="#plan-optimis%C3%A9-dans-lespace-des-covariables"><span class="header-section-number">7.6</span> Plan optimisé dans l’espace des covariables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#d%C3%A9finition-5"><span class="header-section-number">7.6.1</span> Définition</a></li>
<li><a class="nav-link" href="#donn%C3%A9es"><span class="header-section-number">7.6.2</span> Données</a></li>
<li><a class="nav-link" href="#mise-en-oeuvre-avec-lalgorithme-k-moyennes"><span class="header-section-number">7.6.3</span> Mise en oeuvre avec l’algorithme K-moyennes</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</strong>" was written by Nicolas Saby, INRAe Infosol, Orléans France. It was last built on 2026-01-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
