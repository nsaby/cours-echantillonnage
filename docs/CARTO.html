<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</title>
  <meta name="description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="github-repo" content="nsaby/cours-echantillonnage" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Echantillonnage pour la cartographie | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  
  <meta name="twitter:description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  

<meta name="author" content="Nicolas Saby, INRAe Infosol, Orléans France" />


<meta name="date" content="2021-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SY-QUICK.html"/>
<link rel="next" href="Script.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cours Echantillonnage Sol</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bienvenue</a></li>
<li class="chapter" data-level="2" data-path="WHY.html"><a href="WHY.html"><i class="fa fa-check"></i><b>2</b> Pourquoi ce cours</a>
<ul>
<li class="chapter" data-level="2.1" data-path="WHY.html"><a href="WHY.html#motivations"><i class="fa fa-check"></i><b>2.1</b> Motivations</a></li>
<li class="chapter" data-level="2.2" data-path="WHY.html"><a href="WHY.html#définition"><i class="fa fa-check"></i><b>2.2</b> Définition</a></li>
<li class="chapter" data-level="2.3" data-path="WHY.html"><a href="WHY.html#contenu"><i class="fa fa-check"></i><b>2.3</b> Contenu</a></li>
<li class="chapter" data-level="2.4" data-path="WHY.html"><a href="WHY.html#objectifs-dune-étude-de-sol"><i class="fa fa-check"></i><b>2.4</b> Objectifs d’une étude de sol</a></li>
<li class="chapter" data-level="2.5" data-path="WHY.html"><a href="WHY.html#léchantillonnage-probabiliste-vs-non-probabiliste"><i class="fa fa-check"></i><b>2.5</b> L’échantillonnage probabiliste vs non probabiliste</a></li>
<li class="chapter" data-level="2.6" data-path="WHY.html"><a href="WHY.html#approche-basée-sur-un-modèle-ou-basée-sur-un-plan-déchantillonnage"><i class="fa fa-check"></i><b>2.6</b> Approche basée sur un modèle ou basée sur un plan d’échantillonnage</a></li>
<li class="chapter" data-level="2.7" data-path="WHY.html"><a href="WHY.html#population-discrète-et-population-continue"><i class="fa fa-check"></i><b>2.7</b> Population discrète et population continue</a></li>
<li class="chapter" data-level="2.8" data-path="WHY.html"><a href="WHY.html#plan"><i class="fa fa-check"></i><b>2.8</b> Plan</a></li>
<li class="chapter" data-level="2.9" data-path="WHY.html"><a href="WHY.html#libraries-utilisées"><i class="fa fa-check"></i><b>2.9</b> Libraries utilisées</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Données</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#statistiques-globales"><i class="fa fa-check"></i><b>3.1</b> Statistiques globales</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#cartographie"><i class="fa fa-check"></i><b>3.2</b> Cartographie</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#contour-dune-parcelle"><i class="fa fa-check"></i><b>3.2.1</b> Contour d’une parcelle</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#covariables-rasters-en-australie"><i class="fa fa-check"></i><b>3.2.2</b> Covariables rasters en Australie</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>4</b> Echantillonnage aléatoire simple</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SI.html"><a href="SI.html#définition-1"><i class="fa fa-check"></i><b>4.1</b> Définition</a></li>
<li class="chapter" data-level="4.2" data-path="SI.html"><a href="SI.html#mise-en-oeuvre-avec-un-logiciel"><i class="fa fa-check"></i><b>4.2</b> Mise en oeuvre avec un logiciel</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="SI.html"><a href="SI.html#excel"><i class="fa fa-check"></i><b>4.2.1</b> Excel</a></li>
<li class="chapter" data-level="4.2.2" data-path="SI.html"><a href="SI.html#avec-r-pour-les-polutations-discrètes"><i class="fa fa-check"></i><b>4.2.2</b> Avec <code>R</code> pour les polutations discrètes</a></li>
<li class="chapter" data-level="4.2.3" data-path="SI.html"><a href="SI.html#avec-r-pour-les-populations-continues"><i class="fa fa-check"></i><b>4.2.3</b> Avec <code>R</code> pour les populations continues</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="SI.html"><a href="SI.html#calcul-des-estimateurs"><i class="fa fa-check"></i><b>4.3</b> Calcul des estimateurs</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="SI.html"><a href="SI.html#lestimateur-de-horvitz-thompson"><i class="fa fa-check"></i><b>4.3.1</b> l’estimateur de Horvitz-Thompson</a></li>
<li class="chapter" data-level="4.3.2" data-path="SI.html"><a href="SI.html#la-moyenne-pour-la-population-discrète-fini"><i class="fa fa-check"></i><b>4.3.2</b> La moyenne pour la population discrète fini</a></li>
<li class="chapter" data-level="4.3.3" data-path="SI.html"><a href="SI.html#la-variance-spatiale-et-variance-déchantillonnage"><i class="fa fa-check"></i><b>4.3.3</b> La variance spatiale et variance d’échantillonnage</a></li>
<li class="chapter" data-level="4.3.4" data-path="SI.html"><a href="SI.html#linterval-de-confiance"><i class="fa fa-check"></i><b>4.3.4</b> l’interval de confiance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="SI.html"><a href="SI.html#simulations"><i class="fa fa-check"></i><b>4.4</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html"><i class="fa fa-check"></i><b>5</b> L’échantillonnage aléatoire stratifié</a>
<ul>
<li class="chapter" data-level="5.1" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#pourquoi-stratifier"><i class="fa fa-check"></i><b>5.1</b> Pourquoi stratifier ?</a></li>
<li class="chapter" data-level="5.2" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#comment-stratifier"><i class="fa fa-check"></i><b>5.2</b> Comment stratifier ?</a></li>
<li class="chapter" data-level="5.3" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#estimateurs-stsi"><i class="fa fa-check"></i><b>5.3</b> Estimateurs STSI</a></li>
<li class="chapter" data-level="5.4" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#stratification-géographique-par-strates-compactes"><i class="fa fa-check"></i><b>5.4</b> Stratification géographique par strates compactes</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#définition-2"><i class="fa fa-check"></i><b>5.4.1</b> Définition</a></li>
<li class="chapter" data-level="5.4.2" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#estimateurs-stsi-1"><i class="fa fa-check"></i><b>5.4.2</b> Estimateurs STSI</a></li>
<li class="chapter" data-level="5.4.3" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#implémentation"><i class="fa fa-check"></i><b>5.4.3</b> Implémentation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="SY-QUICK.html"><a href="SY-QUICK.html"><i class="fa fa-check"></i><b>6</b> Echantillonnage aléatoire systématique</a>
<ul>
<li class="chapter" data-level="6.1" data-path="SY-QUICK.html"><a href="SY-QUICK.html#définitions"><i class="fa fa-check"></i><b>6.1</b> Définitions</a></li>
<li class="chapter" data-level="6.2" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-grille"><i class="fa fa-check"></i><b>6.2</b> Exemple de grille</a></li>
<li class="chapter" data-level="6.3" data-path="SY-QUICK.html"><a href="SY-QUICK.html#théorie"><i class="fa fa-check"></i><b>6.3</b> théorie</a></li>
<li class="chapter" data-level="6.4" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-mise-en-oeuvre"><i class="fa fa-check"></i><b>6.4</b> Exemple de mise en oeuvre</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="CARTO.html"><a href="CARTO.html"><i class="fa fa-check"></i><b>7</b> Echantillonnage pour la cartographie</a>
<ul>
<li class="chapter" data-level="7.1" data-path="CARTO.html"><a href="CARTO.html#caractéristiques"><i class="fa fa-check"></i><b>7.1</b> Caractéristiques</a></li>
<li class="chapter" data-level="7.2" data-path="CARTO.html"><a href="CARTO.html#différents-types-de-plans"><i class="fa fa-check"></i><b>7.2</b> Différents types de plans</a></li>
<li class="chapter" data-level="7.3" data-path="CARTO.html"><a href="CARTO.html#la-grille-systématique"><i class="fa fa-check"></i><b>7.3</b> La grille systématique</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="CARTO.html"><a href="CARTO.html#caractéristiques-1"><i class="fa fa-check"></i><b>7.3.1</b> Caractéristiques</a></li>
<li class="chapter" data-level="7.3.2" data-path="CARTO.html"><a href="CARTO.html#implémentation-1"><i class="fa fa-check"></i><b>7.3.2</b> Implémentation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="CARTO.html"><a href="CARTO.html#echantillonnage-spatial-optimisé"><i class="fa fa-check"></i><b>7.4</b> Echantillonnage spatial optimisé</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="CARTO.html"><a href="CARTO.html#définition-3"><i class="fa fa-check"></i><b>7.4.1</b> Définition</a></li>
<li class="chapter" data-level="7.4.2" data-path="CARTO.html"><a href="CARTO.html#mise-en-oeuvre-avec-spcosa"><i class="fa fa-check"></i><b>7.4.2</b> Mise en oeuvre avec <code>spcosa</code></a></li>
<li class="chapter" data-level="7.4.3" data-path="CARTO.html"><a href="CARTO.html#en-présence-de-données-existantes"><i class="fa fa-check"></i><b>7.4.3</b> En présence de données existantes</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="CARTO.html"><a href="CARTO.html#echantillonnage-pour-la-géostatitique"><i class="fa fa-check"></i><b>7.5</b> Echantillonnage pour la géostatitique</a></li>
<li class="chapter" data-level="7.6" data-path="CARTO.html"><a href="CARTO.html#plan-optimisé-dans-lespace-des-covariables"><i class="fa fa-check"></i><b>7.6</b> Plan optimisé dans l’espace des covariables</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="CARTO.html"><a href="CARTO.html#définition-4"><i class="fa fa-check"></i><b>7.6.1</b> Définition</a></li>
<li class="chapter" data-level="7.6.2" data-path="CARTO.html"><a href="CARTO.html#données"><i class="fa fa-check"></i><b>7.6.2</b> Données</a></li>
<li class="chapter" data-level="7.6.3" data-path="CARTO.html"><a href="CARTO.html#mise-en-oeuvre-avec-lalgorithme-k-moyennes"><i class="fa fa-check"></i><b>7.6.3</b> Mise en oeuvre avec l’algorithme K-moyennes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Script.html"><a href="Script.html"><i class="fa fa-check"></i><b>8</b> Script final</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="CARTO" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Echantillonnage pour la cartographie</h1>
<div id="caractéristiques" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Caractéristiques</h2>
<ul>
<li><p>Lorsque les paramètres de la population (moyenne ou total, percentiles) à étudier ou pour plusieurs sous-régions n’est pas suffisant</p></li>
<li><p>La résolution spatiale requise pour la cartographie est bien plus importante que pour les statstisque globale</p></li>
<li><p>Quelles Méthodes de cartographie :</p>
<ul>
<li>Méthodes d’interpolation spatiale heuristique : Polygones de Thiessen, triangulation, voisin naturel, distance inverse</li>
<li>Interpolation spatiale basée sur un modèle stochastique : le krigeage</li>
<li>Modèle non spatial : modèle de régression linéaire, arbre de régression, forêt aléatoire</li>
</ul></li>
</ul>
</div>
<div id="différents-types-de-plans" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Différents types de plans</h2>
<ul>
<li><p>Echantillonnage pour la cartographie par interpolation spatiale</p>
<ul>
<li>Plans d’échantillonnage géométriques</li>
<li>Grilles régulières</li>
<li>Échantillonnage de la couverture spatiale</li>
<li>Plans d’échantillonnage basés sur des modèles</li>
</ul></li>
<li><p>Echantillonnage pour la cartographie avec des modèles de régression ou par arbres de regression</p>
<ul>
<li>stratification de l’espace des covariables</li>
<li>Échantillonnage par hypercube latin</li>
</ul></li>
</ul>
</div>
<div id="la-grille-systématique" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> La grille systématique</h2>
<div id="caractéristiques-1" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Caractéristiques</h3>
<p>Facile à mettre en œuvre</p>
<ul>
<li>Bonne couverture spatiale</li>
<li>La grille ne doit pas être forcément placée au hasard</li>
<li>Formes : carrées, triangulaires, hexagonales</li>
</ul>
<p>Pour choisir la résolution</p>
<ul>
<li>Le maximum de budget mobilisable</li>
<li>Un seuil pour l’erreur d’interpollation mais dans ce cas, il est nécessaire de poser des hypothèses sur un modèle de variabilité spatiale</li>
</ul>
<p>Avec un échantillonnage par grille régulière, la répartition des observations est fixe (carré, triangulaire)</p>
<ul>
<li><p>Avec des zones de forme irrégulière, la couverture spatiale est dans la plupart des cas sous-optimal. Elle amène souvent à des problème aux bordures en augmentant ainsi les effets de bords</p></li>
<li><p>Une couverture spatiale sous-optimale devient plus problématique lorsque nous disposons de données existantes (données anciennes)</p></li>
<li><p>En présence de données existantes, nous voulons remplir les espaces vides</p></li>
</ul>
</div>
<div id="implémentation-1" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Implémentation</h3>
<p>On teste ici les fonctions en prenant la parcelle du package <code>spcosa</code></p>
<p>Voici l’exemple pour la grille de type régulière à maille carrée. On remarque la présence de zone sans donnée.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="CARTO.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regular</span></span>
<span id="cb61-2"><a href="CARTO.html#cb61-2" aria-hidden="true" tabindex="-1"></a>MagrilleReg <span class="ot">&lt;-</span> <span class="fu">spsample</span>( shpFarmsum ,</span>
<span id="cb61-3"><a href="CARTO.html#cb61-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>,</span>
<span id="cb61-4"><a href="CARTO.html#cb61-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cellsize =</span> <span class="dv">30</span>)</span>
<span id="cb61-5"><a href="CARTO.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="CARTO.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shpFarmsum) <span class="sc">+</span> </span>
<span id="cb61-7"><a href="CARTO.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>( ) <span class="sc">+</span></span>
<span id="cb61-8"><a href="CARTO.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(MagrilleReg) <span class="sc">+</span></span>
<span id="cb61-9"><a href="CARTO.html#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_symbols</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Grilleregfig"></span>
<img src="cours-echantillonnage_files/figure-html/Grilleregfig-1.png" alt="Grille régulière" width="110%" />
<p class="caption">
Figure 7.1: Grille régulière
</p>
</div>
<p>Voici l’exemple pour la grille de type régulière carré. On remarque la présence de zone sans donnée.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="CARTO.html#cb62-1" aria-hidden="true" tabindex="-1"></a>MagrilleHex <span class="ot">&lt;-</span> <span class="fu">spsample</span>( shpFarmsum ,</span>
<span id="cb62-2"><a href="CARTO.html#cb62-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;hexagonal&quot;</span>,</span>
<span id="cb62-3"><a href="CARTO.html#cb62-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cellsize =</span> <span class="dv">30</span>)</span>
<span id="cb62-4"><a href="CARTO.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="CARTO.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shpFarmsum) <span class="sc">+</span> </span>
<span id="cb62-6"><a href="CARTO.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>( ) <span class="sc">+</span></span>
<span id="cb62-7"><a href="CARTO.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(MagrilleHex) <span class="sc">+</span></span>
<span id="cb62-8"><a href="CARTO.html#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_symbols</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GrillerHexfig"></span>
<img src="cours-echantillonnage_files/figure-html/GrillerHexfig-1.png" alt="Echantillonnage optimisé pour le krigeage" width="110%" />
<p class="caption">
Figure 7.2: Echantillonnage optimisé pour le krigeage
</p>
</div>
</div>
</div>
<div id="echantillonnage-spatial-optimisé" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Echantillonnage spatial optimisé</h2>
<div id="définition-3" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Définition</h3>
<p>Dans cette approche, les <span class="math inline">\(n\)</span> observations sont réparties de manière optimale au sein de la zone d’étude. Pour cela, on utilise un critère qui minimise la distance entre les observations et les points de la grille régulière de prédiction.
La moyenne du carré de la plus courte distance au point j:</p>
<p><span class="math inline">\(MCPCD_j = 1/N \sum^N_{i=1}min_j(D_{ij}^2)\)</span></p>
<p>Le critère <span class="math inline">\(MCPCD_j\)</span> peut être minmisé en utilisant l’algorithme des K-moyenne</p>
<p>Il existe un package R <code>spcosa</code> de <span class="citation"><a href="#ref-walvoort_r_2010" role="doc-biblioref">Walvoort, Brus, and Gruijter</a> (<a href="#ref-walvoort_r_2010" role="doc-biblioref">2010</a>)</span>.</p>
<p>Dans cette appraoche, il n’est pas nécessaire de définir un variogramme a priori pour l’optimisation de la répartition des <span class="math inline">\(n\)</span> observations. Les strates ainsi définies sont appelées <strong>Strates compactes</strong></p>
</div>
<div id="mise-en-oeuvre-avec-spcosa" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Mise en oeuvre avec <code>spcosa</code></h3>
<p>La fonction <code>stratify</code> implémente la stratification dite par strate compacte.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="CARTO.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize pseudo random number generator</span></span>
<span id="cb63-2"><a href="CARTO.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">700124</span>)</span>
<span id="cb63-3"><a href="CARTO.html#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="CARTO.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stratify Farmsum into 50 strata</span></span>
<span id="cb63-5"><a href="CARTO.html#cb63-5" aria-hidden="true" tabindex="-1"></a>myStratification <span class="ot">&lt;-</span> <span class="fu">stratify</span>(shpFarmsum, <span class="at">nStrata =</span> <span class="dv">30</span>)</span>
<span id="cb63-6"><a href="CARTO.html#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="CARTO.html#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot stratification</span></span>
<span id="cb63-8"><a href="CARTO.html#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myStratification)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Sans option, la commande spcosa::spsample extrait le centroïde des strates obtenues par l’algorithme des K-moyennes.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="CARTO.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sans option, la commande spcosa::spsample extrait le centroïde de la strate.</span></span>
<span id="cb64-2"><a href="CARTO.html#cb64-2" aria-hidden="true" tabindex="-1"></a>mySamplingPattern <span class="ot">&lt;-</span> <span class="fu">spsample</span>(myStratification)</span>
<span id="cb64-3"><a href="CARTO.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="CARTO.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot sampling pattern</span></span>
<span id="cb64-5"><a href="CARTO.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myStratification, mySamplingPattern)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="en-présence-de-données-existantes" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> En présence de données existantes</h3>
<p>Supposons l’existance d’un <span class="math inline">\(k\)</span> échantillons sur la zone</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="CARTO.html#cb65-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb65-2"><a href="CARTO.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb65-3"><a href="CARTO.html#cb65-3" aria-hidden="true" tabindex="-1"></a>MonEchAncien <span class="ot">&lt;-</span> <span class="fu">spsample</span>( shpFarmsum , k , <span class="at">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb65-4"><a href="CARTO.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(MonEchAncien)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>La commande <code>spcosa::stratify</code> permet de construire les strates compactes en tenant compte de ces observations afin d’optimiser la répartition des échantillons supplémentaires pour la cartographie</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="CARTO.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Set number of new sampling locations to be selected</span></span>
<span id="cb66-2"><a href="CARTO.html#cb66-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb66-3"><a href="CARTO.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="CARTO.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute total sample size (existing points + new points)</span></span>
<span id="cb66-5"><a href="CARTO.html#cb66-5" aria-hidden="true" tabindex="-1"></a>ntot<span class="ot">&lt;-</span>n<span class="sc">+</span>k</span>
<span id="cb66-6"><a href="CARTO.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute geostrata with option priorPoints=priordataEthiopia</span></span>
<span id="cb66-7"><a href="CARTO.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb66-8"><a href="CARTO.html#cb66-8" aria-hidden="true" tabindex="-1"></a>myStrata <span class="ot">&lt;-</span> <span class="fu">stratify</span>(shpFarmsum, </span>
<span id="cb66-9"><a href="CARTO.html#cb66-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cellSize=</span> <span class="dv">2</span> ,</span>
<span id="cb66-10"><a href="CARTO.html#cb66-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nStrata =</span> ntot,</span>
<span id="cb66-11"><a href="CARTO.html#cb66-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">priorPoints=</span>MonEchAncien,</span>
<span id="cb66-12"><a href="CARTO.html#cb66-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nTry=</span><span class="dv">10</span>)</span>
<span id="cb66-13"><a href="CARTO.html#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="CARTO.html#cb66-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-15"><a href="CARTO.html#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Select sampling points of infill sample (centres of geostrata)</span></span>
<span id="cb66-16"><a href="CARTO.html#cb66-16" aria-hidden="true" tabindex="-1"></a>mySample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(myStrata)</span></code></pre></div>
<p>Voici la répartition des points.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="CARTO.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot geostrata and sampling points (centres of geostrata)</span></span>
<span id="cb67-2"><a href="CARTO.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myStrata, mySample)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
</div>
<div id="echantillonnage-pour-la-géostatitique" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Echantillonnage pour la géostatitique</h2>
<p>Dans une récente étude, <span class="citation"><a href="#ref-wadoux_efficient_2019" role="doc-biblioref">Wadoux, Marchant, and Lark</a> (<a href="#ref-wadoux_efficient_2019" role="doc-biblioref">2019</a>)</span> propose de rajouter 10 % du nombre total d’observations au plan par couverture spatiale optimisée. Ces points sont positionné à une petite distance de cette sélection au hasard de points.</p>
<p>On définit premièremement la distance <span class="math inline">\(d\)</span> (20 m dans cette exemple) et le nombre de points <span class="math inline">\(m\)</span> (10 %)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="CARTO.html#cb68-1" aria-hidden="true" tabindex="-1"></a>mySCsample.df <span class="ot">&lt;-</span> <span class="fu">as</span>(mySamplingPattern, <span class="st">&quot;data.frame&quot;</span>) <span class="co"># on extrait ici les coordonnées</span></span>
<span id="cb68-2"><a href="CARTO.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="CARTO.html#cb68-3" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Distance</span></span>
<span id="cb68-4"><a href="CARTO.html#cb68-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">round</span>( <span class="fl">0.1</span>  <span class="sc">*</span> <span class="fu">nrow</span>(mySCsample.df)) <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>On tire ensuite au hasard les <span class="math inline">\(m\)</span> points et on calcule les nouvelles coordonnées afin de placer au hasard le nouveau points sur un cercle de rayon <span class="math inline">\(d\)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="CARTO.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify separation distances and subsample sizes</span></span>
<span id="cb69-2"><a href="CARTO.html#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="CARTO.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select random subsample from the spatial coverage sample</span></span>
<span id="cb69-4"><a href="CARTO.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb69-5"><a href="CARTO.html#cb69-5" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">nrow</span>(mySCsample.df),</span>
<span id="cb69-6"><a href="CARTO.html#cb69-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> m)</span>
<span id="cb69-7"><a href="CARTO.html#cb69-7" aria-hidden="true" tabindex="-1"></a>mySubsample <span class="ot">&lt;-</span> mySCsample.df[ids,]</span>
<span id="cb69-8"><a href="CARTO.html#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="CARTO.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select locations in random direction at distances h from subsample</span></span>
<span id="cb69-10"><a href="CARTO.html#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="CARTO.html#cb69-11" aria-hidden="true" tabindex="-1"></a>plus <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb69-12"><a href="CARTO.html#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="CARTO.html#cb69-13" aria-hidden="true" tabindex="-1"></a>  dxy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>m,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb69-14"><a href="CARTO.html#cb69-14" aria-hidden="true" tabindex="-1"></a>  angle<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="at">n =</span> m,</span>
<span id="cb69-15"><a href="CARTO.html#cb69-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb69-16"><a href="CARTO.html#cb69-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">max =</span> <span class="dv">2</span><span class="sc">*</span>pi</span>
<span id="cb69-17"><a href="CARTO.html#cb69-17" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb69-18"><a href="CARTO.html#cb69-18" aria-hidden="true" tabindex="-1"></a>  dxy[,<span class="dv">1</span>] <span class="ot">&lt;-</span> h <span class="sc">*</span> <span class="fu">sin</span>(angle)</span>
<span id="cb69-19"><a href="CARTO.html#cb69-19" aria-hidden="true" tabindex="-1"></a>  dxy[,<span class="dv">2</span>] <span class="ot">&lt;-</span> h <span class="sc">*</span> <span class="fu">cos</span>(angle)</span>
<span id="cb69-20"><a href="CARTO.html#cb69-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-21"><a href="CARTO.html#cb69-21" aria-hidden="true" tabindex="-1"></a>  plus.h<span class="ot">&lt;-</span>mySubsample<span class="sc">+</span>dxy</span>
<span id="cb69-22"><a href="CARTO.html#cb69-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-23"><a href="CARTO.html#cb69-23" aria-hidden="true" tabindex="-1"></a>mySCsample.df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mySCsample.df,plus.h)</span>
<span id="cb69-24"><a href="CARTO.html#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="CARTO.html#cb69-25" aria-hidden="true" tabindex="-1"></a>mySCsample.df<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">row.names</span>(mySCsample.df)</span>
<span id="cb69-26"><a href="CARTO.html#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(mySCsample.df) <span class="ot">&lt;-</span> <span class="er">~</span>x1<span class="sc">+</span> x2</span></code></pre></div>
<p>Voici la représentation du plan d’échantillonnage pour la géostatistique.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="CARTO.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shpFarmsum)<span class="sc">+</span> <span class="fu">tm_borders</span>()<span class="sc">+</span></span>
<span id="cb70-2"><a href="CARTO.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mySCsample.df) <span class="sc">+</span> <span class="fu">tm_symbols</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PlusSample"></span>
<img src="cours-echantillonnage_files/figure-html/PlusSample-1.png" alt="Plan optimisé pour la géostatistique" width="110%" />
<p class="caption">
Figure 7.3: Plan optimisé pour la géostatistique
</p>
</div>
</div>
<div id="plan-optimisé-dans-lespace-des-covariables" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Plan optimisé dans l’espace des covariables</h2>
<div id="définition-4" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Définition</h3>
<p>Dans cette partie, l’échantillons doit permettre de calibrer un modèle de regression avec des covariables spatialisées. Il existe de nombreuse méthodes pour sélectionner des unités d’échantillonnage de sorte qu’elle permette d</p>
<ul>
<li>cLHS</li>
<li>Surface response design</li>
<li></li>
</ul>
</div>
<div id="données" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Données</h3>
<p>Comme présenté dans le chapitre sur les données, nous utilisons un jeu de données consitué de grille décrivant un ensemble de caractéristiques d’une parcelle en Australie.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="CARTO.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Read data with coordinates and other attributes of fine grid (discretization of study area)</span></span>
<span id="cb71-2"><a href="CARTO.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;Data/HunterValley4Practicals.RData&quot;</span>)</span>
<span id="cb71-3"><a href="CARTO.html#cb71-3" aria-hidden="true" tabindex="-1"></a>grdHunterValley2 <span class="ot">&lt;-</span> grdHunterValley</span>
<span id="cb71-4"><a href="CARTO.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(grdHunterValley2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Easting&#39;</span>,<span class="st">&#39;Northing&#39;</span>)</span>
<span id="cb71-5"><a href="CARTO.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gridded</span>(grdHunterValley2) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb71-6"><a href="CARTO.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="CARTO.html#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(grdHunterValley2) <span class="sc">+</span> </span>
<span id="cb71-8"><a href="CARTO.html#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;elevation_m&quot;</span>,<span class="st">&quot;slope_deg&quot;</span>,<span class="st">&quot;cti&quot;</span>,<span class="st">&quot;ndvi&quot;</span>) )</span></code></pre></div>
<pre><code>## Variable(s) &quot;ndvi&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="mise-en-oeuvre-avec-lalgorithme-k-moyennes" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Mise en oeuvre avec l’algorithme K-moyennes</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="CARTO.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Set number of sampling locations to be selected</span></span>
<span id="cb73-2"><a href="CARTO.html#cb73-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb73-3"><a href="CARTO.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="CARTO.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute clusters</span></span>
<span id="cb73-5"><a href="CARTO.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>)</span>
<span id="cb73-6"><a href="CARTO.html#cb73-6" aria-hidden="true" tabindex="-1"></a>myClusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(grdHunterValley[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>)]), <span class="at">centers=</span>n, <span class="at">iter.max=</span><span class="dv">100</span>,<span class="at">nstart=</span><span class="dv">10</span>)</span>
<span id="cb73-7"><a href="CARTO.html#cb73-7" aria-hidden="true" tabindex="-1"></a>grdHunterValley<span class="sc">$</span>clusters <span class="ot">&lt;-</span> myClusters<span class="sc">$</span>cluster</span>
<span id="cb73-8"><a href="CARTO.html#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="CARTO.html#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Select locations closest to the centers of the clusters</span></span>
<span id="cb73-10"><a href="CARTO.html#cb73-10" aria-hidden="true" tabindex="-1"></a>rdist.out <span class="ot">&lt;-</span> <span class="fu">rdist</span>(<span class="at">x1=</span>myClusters<span class="sc">$</span>centers,<span class="at">x2=</span><span class="fu">scale</span>(grdHunterValley[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)]))</span>
<span id="cb73-11"><a href="CARTO.html#cb73-11" aria-hidden="true" tabindex="-1"></a>ids.mindist <span class="ot">&lt;-</span> <span class="fu">apply</span>(rdist.out,<span class="at">MARGIN=</span><span class="dv">1</span>,which.min)</span>
<span id="cb73-12"><a href="CARTO.html#cb73-12" aria-hidden="true" tabindex="-1"></a>mySample <span class="ot">&lt;-</span> grdHunterValley[ids.mindist,]</span></code></pre></div>
<p>Dans cette</p>
<p>Il est possible de représenter les unités d’échantillonnage dans l’espace géographique:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="CARTO.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grdHunterValley) <span class="sc">+</span></span>
<span id="cb74-2"><a href="CARTO.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Easting, <span class="at">y =</span> Northing, <span class="at">fill =</span> <span class="fu">factor</span>(clusters))) <span class="sc">+</span></span>
<span id="cb74-3"><a href="CARTO.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;cluster&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-4"><a href="CARTO.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>mySample,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Easting,<span class="at">y=</span>Northing),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="CARTO.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="CARTO.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="CARTO.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb74-8"><a href="CARTO.html#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:KMsample"></span>
<img src="cours-echantillonnage_files/figure-html/KMsample-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace géographique" width="110%" />
<p class="caption">
Figure 7.4: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace géographique
</p>
</div>
<p>Mais également dans l’espace des covariables. Ici, on retient l’altitude et le CTI.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="CARTO.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grdHunterValley) <span class="sc">+</span></span>
<span id="cb75-2"><a href="CARTO.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>elevation_m,<span class="at">x=</span>cti,<span class="at">colour=</span><span class="fu">factor</span>(clusters)), <span class="at">size =</span> .<span class="dv">51</span>) <span class="sc">+</span></span>
<span id="cb75-3"><a href="CARTO.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>mySample,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>elevation_m,<span class="at">x=</span>cti),<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="CARTO.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Elevation&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="CARTO.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;ndvi&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="CARTO.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:KMSample2"></span>
<img src="cours-echantillonnage_files/figure-html/KMSample2-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace des covariables" width="110%" />
<p class="caption">
Figure 7.5: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace des covariables
</p>
</div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="CARTO.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grdHunterValley) <span class="sc">+</span></span>
<span id="cb76-2"><a href="CARTO.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>elevation_m,<span class="at">x=</span>slope_deg,<span class="at">colour=</span><span class="fu">factor</span>(clusters)), <span class="at">size =</span> .<span class="dv">51</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="CARTO.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>mySample,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>elevation_m,<span class="at">x=</span>cti),<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb76-4"><a href="CARTO.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Elevation&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-5"><a href="CARTO.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Slope&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="CARTO.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:KMSample3"></span>
<img src="cours-echantillonnage_files/figure-html/KMSample3-1.png" alt="Plan optimisé par K-moyenne sur les covariables, représentation dans l'espace des covariables" width="110%" />
<p class="caption">
Figure 7.6: Plan optimisé par K-moyenne sur les covariables, représentation dans l’espace des covariables
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-wadoux_efficient_2019" class="csl-entry">
Wadoux, Alexandre M. J. C., Benjamin P. Marchant, and Richard M. Lark. 2019. <span>“Efficient Sampling for Geostatistical Surveys.”</span> <em>European Journal of Soil Science</em>, May. <a href="https://doi.org/10.1111/ejss.12797">https://doi.org/10.1111/ejss.12797</a>.
</div>
<div id="ref-walvoort_r_2010" class="csl-entry">
Walvoort, D. J. J., D. J. Brus, and J. J. de Gruijter. 2010. <span>“An <span>R</span> Package for Spatial Coverage Sampling and Random Sampling from Compact Geographical Strata by k-Means.”</span> <em>Computers &amp; Geosciences</em> 36 (10): 1261–67.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SY-QUICK.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Script.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cours-echantillonnage.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
