<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 L’échantillonnage aléatoire stratifié | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</title>
  <meta name="description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 L’échantillonnage aléatoire stratifié | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="github-repo" content="nsaby/cours-echantillonnage" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 L’échantillonnage aléatoire stratifié | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  
  <meta name="twitter:description" content="Notes de cours M1 Master IHBV de Tours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  

<meta name="author" content="Nicolas Saby, INRAe Infosol, Orléans France" />


<meta name="date" content="2021-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SI.html"/>
<link rel="next" href="SY-QUICK.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cours Echantillonnage Sol</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bienvenue</a></li>
<li class="chapter" data-level="2" data-path="WHY.html"><a href="WHY.html"><i class="fa fa-check"></i><b>2</b> Pourquoi ce cours</a>
<ul>
<li class="chapter" data-level="2.1" data-path="WHY.html"><a href="WHY.html#motivations"><i class="fa fa-check"></i><b>2.1</b> Motivations</a></li>
<li class="chapter" data-level="2.2" data-path="WHY.html"><a href="WHY.html#définition"><i class="fa fa-check"></i><b>2.2</b> Définition</a></li>
<li class="chapter" data-level="2.3" data-path="WHY.html"><a href="WHY.html#contenu"><i class="fa fa-check"></i><b>2.3</b> Contenu</a></li>
<li class="chapter" data-level="2.4" data-path="WHY.html"><a href="WHY.html#objectifs-dune-étude-de-sol"><i class="fa fa-check"></i><b>2.4</b> Objectifs d’une étude de sol</a></li>
<li class="chapter" data-level="2.5" data-path="WHY.html"><a href="WHY.html#léchantillonnage-probabiliste-vs-non-probabiliste"><i class="fa fa-check"></i><b>2.5</b> L’échantillonnage probabiliste vs non probabiliste</a></li>
<li class="chapter" data-level="2.6" data-path="WHY.html"><a href="WHY.html#approche-basée-sur-un-modèle-ou-basée-sur-un-plan-déchantillonnage"><i class="fa fa-check"></i><b>2.6</b> Approche basée sur un modèle ou basée sur un plan d’échantillonnage</a></li>
<li class="chapter" data-level="2.7" data-path="WHY.html"><a href="WHY.html#population-discrète-et-population-continue"><i class="fa fa-check"></i><b>2.7</b> Population discrète et population continue</a></li>
<li class="chapter" data-level="2.8" data-path="WHY.html"><a href="WHY.html#plan"><i class="fa fa-check"></i><b>2.8</b> Plan</a></li>
<li class="chapter" data-level="2.9" data-path="WHY.html"><a href="WHY.html#libraries-utilisées"><i class="fa fa-check"></i><b>2.9</b> Libraries utilisées</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Données</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#statistiques-globales"><i class="fa fa-check"></i><b>3.1</b> Statistiques globales</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#cartographie"><i class="fa fa-check"></i><b>3.2</b> Cartographie</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#contour-dune-parcelle"><i class="fa fa-check"></i><b>3.2.1</b> Contour d’une parcelle</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#covariables-rasters-en-australie"><i class="fa fa-check"></i><b>3.2.2</b> Covariables rasters en Australie</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>4</b> Echantillonnage aléatoire simple</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SI.html"><a href="SI.html#définition-1"><i class="fa fa-check"></i><b>4.1</b> Définition</a></li>
<li class="chapter" data-level="4.2" data-path="SI.html"><a href="SI.html#mise-en-oeuvre-avec-un-logiciel"><i class="fa fa-check"></i><b>4.2</b> Mise en oeuvre avec un logiciel</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="SI.html"><a href="SI.html#excel"><i class="fa fa-check"></i><b>4.2.1</b> Excel</a></li>
<li class="chapter" data-level="4.2.2" data-path="SI.html"><a href="SI.html#avec-r-pour-les-polutations-discrètes"><i class="fa fa-check"></i><b>4.2.2</b> Avec <code>R</code> pour les polutations discrètes</a></li>
<li class="chapter" data-level="4.2.3" data-path="SI.html"><a href="SI.html#avec-r-pour-les-populations-continues"><i class="fa fa-check"></i><b>4.2.3</b> Avec <code>R</code> pour les populations continues</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="SI.html"><a href="SI.html#calcul-des-estimateurs"><i class="fa fa-check"></i><b>4.3</b> Calcul des estimateurs</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="SI.html"><a href="SI.html#lestimateur-de-horvitz-thompson"><i class="fa fa-check"></i><b>4.3.1</b> l’estimateur de Horvitz-Thompson</a></li>
<li class="chapter" data-level="4.3.2" data-path="SI.html"><a href="SI.html#la-moyenne-pour-la-population-discrète-fini"><i class="fa fa-check"></i><b>4.3.2</b> La moyenne pour la population discrète fini</a></li>
<li class="chapter" data-level="4.3.3" data-path="SI.html"><a href="SI.html#la-variance-spatiale-et-variance-déchantillonnage"><i class="fa fa-check"></i><b>4.3.3</b> La variance spatiale et variance d’échantillonnage</a></li>
<li class="chapter" data-level="4.3.4" data-path="SI.html"><a href="SI.html#linterval-de-confiance"><i class="fa fa-check"></i><b>4.3.4</b> l’interval de confiance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="SI.html"><a href="SI.html#simulations"><i class="fa fa-check"></i><b>4.4</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html"><i class="fa fa-check"></i><b>5</b> L’échantillonnage aléatoire stratifié</a>
<ul>
<li class="chapter" data-level="5.1" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#pourquoi-stratifier"><i class="fa fa-check"></i><b>5.1</b> Pourquoi stratifier ?</a></li>
<li class="chapter" data-level="5.2" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#comment-stratifier"><i class="fa fa-check"></i><b>5.2</b> Comment stratifier ?</a></li>
<li class="chapter" data-level="5.3" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#estimateurs-stsi"><i class="fa fa-check"></i><b>5.3</b> Estimateurs STSI</a></li>
<li class="chapter" data-level="5.4" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#stratification-géographique-par-strates-compactes"><i class="fa fa-check"></i><b>5.4</b> Stratification géographique par strates compactes</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#définition-2"><i class="fa fa-check"></i><b>5.4.1</b> Définition</a></li>
<li class="chapter" data-level="5.4.2" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#estimateurs-stsi-1"><i class="fa fa-check"></i><b>5.4.2</b> Estimateurs STSI</a></li>
<li class="chapter" data-level="5.4.3" data-path="léchantillonnage-aléatoire-stratifié.html"><a href="léchantillonnage-aléatoire-stratifié.html#implémentation"><i class="fa fa-check"></i><b>5.4.3</b> Implémentation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="SY-QUICK.html"><a href="SY-QUICK.html"><i class="fa fa-check"></i><b>6</b> Echantillonnage aléatoire systématique</a>
<ul>
<li class="chapter" data-level="6.1" data-path="SY-QUICK.html"><a href="SY-QUICK.html#définitions"><i class="fa fa-check"></i><b>6.1</b> Définitions</a></li>
<li class="chapter" data-level="6.2" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-grille"><i class="fa fa-check"></i><b>6.2</b> Exemple de grille</a></li>
<li class="chapter" data-level="6.3" data-path="SY-QUICK.html"><a href="SY-QUICK.html#théorie"><i class="fa fa-check"></i><b>6.3</b> théorie</a></li>
<li class="chapter" data-level="6.4" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-mise-en-oeuvre"><i class="fa fa-check"></i><b>6.4</b> Exemple de mise en oeuvre</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="CARTO.html"><a href="CARTO.html"><i class="fa fa-check"></i><b>7</b> Echantillonnage pour la cartographie</a>
<ul>
<li class="chapter" data-level="7.1" data-path="CARTO.html"><a href="CARTO.html#caractéristiques"><i class="fa fa-check"></i><b>7.1</b> Caractéristiques</a></li>
<li class="chapter" data-level="7.2" data-path="CARTO.html"><a href="CARTO.html#différents-types-de-plans"><i class="fa fa-check"></i><b>7.2</b> Différents types de plans</a></li>
<li class="chapter" data-level="7.3" data-path="CARTO.html"><a href="CARTO.html#la-grille-systématique"><i class="fa fa-check"></i><b>7.3</b> La grille systématique</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="CARTO.html"><a href="CARTO.html#caractéristiques-1"><i class="fa fa-check"></i><b>7.3.1</b> Caractéristiques</a></li>
<li class="chapter" data-level="7.3.2" data-path="CARTO.html"><a href="CARTO.html#implémentation-1"><i class="fa fa-check"></i><b>7.3.2</b> Implémentation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="CARTO.html"><a href="CARTO.html#echantillonnage-spatial-optimisé"><i class="fa fa-check"></i><b>7.4</b> Echantillonnage spatial optimisé</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="CARTO.html"><a href="CARTO.html#définition-3"><i class="fa fa-check"></i><b>7.4.1</b> Définition</a></li>
<li class="chapter" data-level="7.4.2" data-path="CARTO.html"><a href="CARTO.html#mise-en-oeuvre-avec-spcosa"><i class="fa fa-check"></i><b>7.4.2</b> Mise en oeuvre avec <code>spcosa</code></a></li>
<li class="chapter" data-level="7.4.3" data-path="CARTO.html"><a href="CARTO.html#en-présence-de-données-existantes"><i class="fa fa-check"></i><b>7.4.3</b> En présence de données existantes</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="CARTO.html"><a href="CARTO.html#echantillonnage-pour-la-géostatitique"><i class="fa fa-check"></i><b>7.5</b> Echantillonnage pour la géostatitique</a></li>
<li class="chapter" data-level="7.6" data-path="CARTO.html"><a href="CARTO.html#plan-optimisé-dans-lespace-des-covariables"><i class="fa fa-check"></i><b>7.6</b> Plan optimisé dans l’espace des covariables</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="CARTO.html"><a href="CARTO.html#définition-4"><i class="fa fa-check"></i><b>7.6.1</b> Définition</a></li>
<li class="chapter" data-level="7.6.2" data-path="CARTO.html"><a href="CARTO.html#données"><i class="fa fa-check"></i><b>7.6.2</b> Données</a></li>
<li class="chapter" data-level="7.6.3" data-path="CARTO.html"><a href="CARTO.html#mise-en-oeuvre-avec-lalgorithme-k-moyennes"><i class="fa fa-check"></i><b>7.6.3</b> Mise en oeuvre avec l’algorithme K-moyennes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Script.html"><a href="Script.html"><i class="fa fa-check"></i><b>8</b> Script final</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="léchantillonnage-aléatoire-stratifié" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> L’échantillonnage aléatoire stratifié</h1>
<p>Pour ce type d’approche, la population ou la zone d’étude est subdivisée en sous-populations, appelées
strates.</p>
<ul>
<li>Les strates ne peuvent pas se chevaucher, et leur union doit correspondre à la population étudiée.</li>
<li>Dans chaque strate, un échantillon est sélectionné au hasard</li>
<li>Les strates peuvent être échantillonnées de nombreuses manières, par exemple par échantillonnage aléatoire (SI). Cela conduit à un échantillonnage aléatoire simple stratifié (STSI)</li>
<li>La méthode de sélection des unité par SI est appliquée à chaque strate séparément</li>
</ul>
<div id="pourquoi-stratifier" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Pourquoi stratifier ?</h2>
<p>Deux raisons possibles :</p>
<ul>
<li>Les estimations des paramètres statistiques pour la zone sont plus précises</li>
<li>Nous voulons des estimations séparées des paramètres statistiques pour les sous-populations</li>
</ul>
</div>
<div id="comment-stratifier" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Comment stratifier ?</h2>
<p>Deux approches :</p>
<ul>
<li><p>Stratification à l’aide d’un variables auxiliaires</p></li>
<li><p>Variable catégorielle (unités cartographiques)</p></li>
<li><p>variable quantitative (par exemple, images de télédétection)</p></li>
<li><p>Stratification par la position géographique uniquement (X et Y)</p></li>
</ul>
</div>
<div id="estimateurs-stsi" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Estimateurs STSI</h2>
<p>L’estimateur de la moyenne STSI est le suivant</p>
<p><span class="math inline">\(\hat{ \overline{z} } = \sum_{h=1}^{H} w_h \hat{\overline{z} }_{h}\)</span></p>
<p>avec <span class="math inline">\(w_h = A_h/\sum_{h}A_h\)</span> et <span class="math inline">\(\hat{\overline{z} }_{h}\)</span> est l’estimateur SI de chaque strate <span class="math inline">\(h\)</span> avec un échantillonnage aléatoire simple.</p>
<p>La variance d’échantillonnage de la moyenne expérimentale des <span class="math inline">\(z\)</span> est :</p>
<p><span class="math display">\[\begin{equation}

V(\hat{ \overline{z^l} } )  = \sum_{h=1}^{H} w_h^2 \frac{ \hat{ S^2_h} (\hat{ \overline{z^l} } ) }{n_h}
\end{equation}\]</span></p>
<p>où <span class="math inline">\(\hat{ S^2_h} (\hat{ \overline{z^l} })\)</span> est la variance SI dans la strate <span class="math inline">\(h\)</span> :</p>
<p><span class="math display">\[\begin{equation}
\hat{ S^2_h} (\hat{ \overline{z^l} })= \frac{1}{n_h-1}\sum_{i=1}^{n_h} ( z^l_{hi}  -\hat{\overline{z}}_h^l )
\end{equation}\]</span></p>
</div>
<div id="stratification-géographique-par-strates-compactes" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Stratification géographique par strates compactes</h2>
<p>Parfois, il n’existe pas d’information a priori sur la variabilité spatiale de la propriété visée. Dans ce cas, une bonne répartition spatiale peut</p>
<div id="définition-2" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Définition</h3>
<p>Dans cette approche, les <span class="math inline">\(n\)</span> observations sont réparties de manière optimale au sein de la zone d’étude. Pour cela, on utilise un critère qui minimise la distance entre les observations et un discrétisation de la zone d’étude.
La moyenne du carré de la plus courte distance au point j:</p>
<p><span class="math inline">\(MCPCD_j = 1/N \sum^N_{i=1}min_j(D_{ij}^2)\)</span></p>
<p>Le critère <span class="math inline">\(MCPCD_j\)</span> peut être minmisé en utilisant l’algorithme des K-moyenne</p>
<p>Il existe un package R <code>spcosa</code> de <span class="citation"><a href="#ref-walvoort_r_2010" role="doc-biblioref">Walvoort, Brus, and Gruijter</a> (<a href="#ref-walvoort_r_2010" role="doc-biblioref">2010</a>)</span>.</p>
<p>Dans cette appraoche, il n’est pas nécessaire de définir un variogramme a priori pour l’optimisation de la répartition des <span class="math inline">\(n\)</span> observations. Les strates ainsi définies sont appelées <strong>Strates compactes</strong></p>
</div>
<div id="estimateurs-stsi-1" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Estimateurs STSI</h3>
<p>Ici, comme les strates ont la même surface et donc le même poids, on peut simplifier les estimateurs</p>
<p>En effet, on peut simplifier les poids : <span class="math inline">\(w_h = A_h/\sum_{h}A_h = 1/H\)</span></p>
<p>La moyenne:</p>
<p><br/>
<span class="math display">\[\begin{equation}

\hat{ \overline{z} } = \sum_{h=1}^{H} \frac1H \hat{\overline{z} }_{h}
\end{equation}\]</span></p>
<p>et</p>
<p><span class="math display">\[\begin{equation}
\hat{\overline{z}}_{h} =\frac1{n_h} \sum_{i=1}^{n_h}z_i
\end{equation}\]</span></p>
<p>Si en plus le nombre d’observations est le même par strate (<span class="math inline">\(n_h\)</span>), on obtient une formule assez simple</p>
<p><span class="math display">\[\begin{equation}

\hat{ \overline{z} } =  \frac1N \sum_{i=1}^{N} z_i
\end{equation}\]</span></p>
<p>Pour la variance d’échantillonnage, il en va de même.</p>
<p><span class="math display">\[\begin{equation}
V(\hat{ \overline{z^l} } )  = (\frac1H)^2 \sum_{h=1}^{H}  \frac{ \hat{ S^2_h} (\hat{ \overline{z^l} } ) }{n_h}
\end{equation}\]</span></p>
</div>
<div id="implémentation" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Implémentation</h3>
<p>Il est conseillé de tirer au hasard 2 points par strate afin de pouvoir calculer une variance. Il suffit ensuite d’adapter le nombre de strate pour atteindre le nombre d’unités d’échantillonnage visé.</p>
<p>Avec cette méthode, il est possible de répartir au mieux les unités dans l’espace.</p>
<p>Ici, on avait retenu 20 unités, soit donc 10 strates.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb39-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb39-3" aria-hidden="true" tabindex="-1"></a>champSP.r <span class="ot">&lt;-</span> <span class="fu">raster</span>(champSP)</span>
<span id="cb39-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">res</span>(champSP.r)</span></code></pre></div>
<pre><code>## [1] 1 1</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate from 1x1 resolution to 3x3 (factor = 3)</span></span>
<span id="cb41-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb41-2" aria-hidden="true" tabindex="-1"></a>champSP.r.aggregate <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(champSP.r, </span>
<span id="cb41-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb41-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fact =</span> <span class="dv">2</span>)</span>
<span id="cb41-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">res</span>(champSP.r.aggregate)</span></code></pre></div>
<pre><code>## [1] 2 2</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-1" aria-hidden="true" tabindex="-1"></a>champSP.r.aggregate <span class="ot">&lt;-</span> <span class="fu">as</span>(champSP.r.aggregate , <span class="st">&quot;SpatialPixels&quot;</span>)</span>
<span id="cb43-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compute compact geographical strata</span></span>
<span id="cb43-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-4" aria-hidden="true" tabindex="-1"></a>myStrata <span class="ot">&lt;-</span> <span class="fu">stratify</span>(champSP.r.aggregate,</span>
<span id="cb43-5"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nStrata =</span> <span class="dv">10</span>,</span>
<span id="cb43-6"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">equalArea=</span><span class="cn">TRUE</span>, </span>
<span id="cb43-7"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nTry=</span><span class="dv">5</span></span>
<span id="cb43-8"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-8" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb43-9"><a href="léchantillonnage-aléatoire-stratifié.html#cb43-9" aria-hidden="true" tabindex="-1"></a>spcosa<span class="sc">::</span><span class="fu">plot</span>(myStrata)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the surface areas of the strata</span></span>
<span id="cb44-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(areaStrata<span class="ot">&lt;-</span><span class="fu">getArea</span>(myStrata))</span></code></pre></div>
<pre><code>##    0    1    2    3    4    5    6    7    8    9 
## 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select randomly n locations from the strata</span></span>
<span id="cb46-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb46-2" aria-hidden="true" tabindex="-1"></a>mySample <span class="ot">&lt;-</span> <span class="fu">spsample</span>(myStrata, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb46-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myStrata, mySample)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<p>Comparons les deux approches: SI et STSI avec strates compactes</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-1" aria-hidden="true" tabindex="-1"></a>STSI <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(champSP) <span class="sc">+</span></span>
<span id="cb47-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>()<span class="sc">+</span></span>
<span id="cb47-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(mySample<span class="sc">@</span>sample)<span class="sc">+</span></span>
<span id="cb47-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>()<span class="sc">+</span></span>
<span id="cb47-5"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-6"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="léchantillonnage-aléatoire-stratifié.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(SI, STSI)</span></code></pre></div>
<p><img src="cours-echantillonnage_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Examinons ce que donne la simulation pour le calcul de la moyenne. On interroge ainsi au droit des pixels les points d’échantillonnage. c’est une opération SIG classique. Puis, on calule la moyenne en utilisant l’estimateur classique.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb48-1" aria-hidden="true" tabindex="-1"></a>terrainSTSI <span class="ot">&lt;-</span> <span class="fu">over</span>(mySample<span class="sc">@</span>sample,champSP)</span>
<span id="cb48-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb48-3" aria-hidden="true" tabindex="-1"></a>MoyEstSTSI <span class="ot">&lt;-</span> <span class="fu">mean</span>(terrainSTSI<span class="sc">$</span>sim1)</span>
<span id="cb48-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="léchantillonnage-aléatoire-stratifié.html#cb48-5" aria-hidden="true" tabindex="-1"></a>MoyEstSTSI</span></code></pre></div>
<pre><code>## [1] 5.459981</code></pre>
<p>Et pour la variance, il est nécessaire de calculer la variance par state et de calculer ensuite la moyenne de ces variances.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb50-1" aria-hidden="true" tabindex="-1"></a>StratesSTSI <span class="ot">&lt;-</span> <span class="fu">over</span>(mySample<span class="sc">@</span>sample,myStrata<span class="sc">@</span>cells)</span>
<span id="cb50-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb50-3" aria-hidden="true" tabindex="-1"></a>myStrata<span class="sc">@</span>stratumId[StratesSTSI]</span></code></pre></div>
<pre><code>##  [1] 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-1" aria-hidden="true" tabindex="-1"></a>Mydata <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(</span>
<span id="cb52-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">strate =</span> myStrata<span class="sc">@</span>stratumId[StratesSTSI],</span>
<span id="cb52-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span> terrainSTSI<span class="sc">$</span>sim1</span>
<span id="cb52-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-5"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-6"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-7" aria-hidden="true" tabindex="-1"></a>Varh<span class="ot">&lt;-</span><span class="fu">tapply</span>(Mydata<span class="sc">$</span>z, <span class="at">INDEX=</span>Mydata<span class="sc">$</span>strate,<span class="at">FUN=</span>var)</span>
<span id="cb52-8"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="léchantillonnage-aléatoire-stratifié.html#cb52-9" aria-hidden="true" tabindex="-1"></a>VStsi <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sum</span>(Varh<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>Voici donc la variance SI <span class="math inline">\(0.0414588\)</span> et la variance dans ce cas <span class="math inline">\(0.0271827\)</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul de l&#39;interval de confiance selon les deux lois</span></span>
<span id="cb53-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-2" aria-hidden="true" tabindex="-1"></a>ICT <span class="ot">&lt;-</span> talpha <span class="sc">*</span> <span class="fu">sqrt</span>(VStsi)</span>
<span id="cb53-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comme n&lt; 30, on garde ICT</span></span>
<span id="cb53-5"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Est-ce que la vraie moyenne est dans l&#39;IC student</span></span>
<span id="cb53-6"><a href="léchantillonnage-aléatoire-stratifié.html#cb53-6" aria-hidden="true" tabindex="-1"></a>Moy <span class="sc">&lt;</span> MoyEstSTSI <span class="sc">+</span> ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb55-1" aria-hidden="true" tabindex="-1"></a>Moy <span class="sc">&gt;</span> MoyEstSTSI <span class="sc">-</span> ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="léchantillonnage-aléatoire-stratifié.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(MoyEstSTSI, </span>
<span id="cb57-2"><a href="léchantillonnage-aléatoire-stratifié.html#cb57-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ICbas =</span> MoyEstSTSI <span class="sc">-</span> ICT,</span>
<span id="cb57-3"><a href="léchantillonnage-aléatoire-stratifié.html#cb57-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">ICHaut =</span> MoyEstSTSI <span class="sc">+</span> ICT, Moy)</span></code></pre></div>
<pre><code>##      MoyEstSTSI  ICbas   ICHaut      Moy
## [1,]   5.459981 5.1149 5.805062 5.298602</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-walvoort_r_2010" class="csl-entry">
Walvoort, D. J. J., D. J. Brus, and J. J. de Gruijter. 2010. <span>“An <span>R</span> Package for Spatial Coverage Sampling and Random Sampling from Compact Geographical Strata by k-Means.”</span> <em>Computers &amp; Geosciences</em> 36 (10): 1261–67.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SY-QUICK.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cours-echantillonnage.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
