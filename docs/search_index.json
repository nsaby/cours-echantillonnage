[["index.html", "Cours Echantillonnage pour létude des propriétés du sol Chapter 1 Pourquoi ce cours 1.1 Motivations 1.2 Contenu 1.3 Objectifs 1.4 LEchantillonnage Probabiliste 1.5 Population discrète et population continue 1.6 Libraries utilisées", " Cours Echantillonnage pour létude des propriétés du sol Nicolas Saby, INRAe Infosol 2021-01-06 Chapter 1 Pourquoi ce cours 1.1 Motivations Les motivations pour ce cours sont les suivantes: Les cours de statistique classique ne sattarde pas sur la discipline de léchantillonnage La conception dun protocole déchantillonnage efficace et efficient est une première étape importante dun projet de recherche Le plan déchantillonnage détermine en grande partie la qualité du résultat final Les problèmes dinférence statistique peuvent souvent être évités lorsque nla réflection commence avant que les données ne soient collectées 1.2 Contenu Proposer une vue densemble des différents plans déchantillonnage pour létude des milieux Connaissance des types de conception de base pour léchantillonnage aléatoire : avantages et inconvénients et des types de conception spatiale plus avancés Connaissance de la manière dont les informations annexes peuvent être utilisées dans le plan déchantillonnage ou dans linférence statistique. Connaissance de la manière dont les échantillons peuvent être sélectionnés dans R, et comment les paramètres statistiques peuvent être estimés et de la manière dont un plan déchantillonnage peut être évalué ex ante avant la collecte des données Ce cours est basé sur les travaux publié dans le livre (Gruijter et al. 2006). Les codes R sont également disponibles dans larticle de Brus et al (Brus 2019) 1.3 Objectifs Objectifs possibles de létude Pour estimer des statistiques sommaires (moyenne, total, proportion) ou la fonction de distribution cumulative spatiale (SCDF) pour létude la zone (population) dans son ensemble La même chose, mais maintenant pour plusieurs sous-domaines Pour cartographier la variable dintérêt Nous ne sommes pas intéressés par les changements au fil du temps La propriété dintérêt ne change pas pendant la période denquête 1.4 LEchantillonnage Probabiliste Pour estimer les totaux ou les moyennes, léchantillonnage probabiliste est le plus approprié Par échantillonnage probabiliste, on entend un échantillonnage aléatoire tel que Toutes les unités de population ont une probabilité &gt; 0 dêtre sélectionnées Les probabilités dinclusion sont connues NB Les probabilités dinclusion ne doivent pas forcément être égales ! Il existe de nombreuses façons de sélectionner les unités de population avec un échantillonnage probabiliste 1.5 Population discrète et population continue Nous devons bien distinguer deux types de populations : Les populations discrètes : les objets naturels discrets correspondent naturellement aux unités déchantillonnage. Le nombre total dunités déchantillonnage dans la population (\\(N\\)) est finie Populations continues : les unités déchantillonnage doivent être définies, par exemple carrés de 1 km × 1 km Mais Nombre total dunités déchantillonnage dans une population continue peut être finie ou infinie Fini : tous les carrés disjoints de 1 km multipliés par 1 km dans une zone Infini : points dans une zone 1.6 Libraries utilisées Nous avons besoin des librairies suivantes library(sp) library(tmap) ## Warning: le package &#39;tmap&#39; a été compilé avec la version R 4.0.3 ## Warning: replacing previous import &#39;vctrs::data_frame&#39; by &#39;tibble::data_frame&#39; ## when loading &#39;dplyr&#39; library(rgdal) ## rgdal: version: 1.5-12, (SVN revision 1018) ## Geospatial Data Abstraction Library extensions to R successfully loaded ## Loaded GDAL runtime: GDAL 3.0.4, released 2020/01/28 ## Path to GDAL shared files: D:/nsaby/R/win-library/4.0/rgdal/gdal ## GDAL binary built with GEOS: TRUE ## Loaded PROJ runtime: Rel. 6.3.1, February 10th, 2020, [PJ_VERSION: 631] ## Path to PROJ shared files: D:/nsaby/R/win-library/4.0/rgdal/proj ## Linking to sp version:1.4-2 ## To mute warnings of possible GDAL/OSR exportToProj4() degradation, ## use options(&quot;rgdal_show_exportToProj4_warnings&quot;=&quot;none&quot;) before loading rgdal. library(ggplot2) References "],["data.html", "Chapter 2 Données", " Chapter 2 Données Nous basons nos exercices sur une réalité simulée dune valeur de carbone dans un parcelle agricole. Ce champ a été simulé en utilisant des techniques géostastitques. Lobjet correspond à un tableau comportant 3 colonnes. les coordonnées avec s1 et s2 les valeurs simulées sim1 Chaque coordonnée correspond au centre dun pixel champ &lt;- read.csv(&#39;data/simulatedField_1Exp25.csv&#39;) head(champ) ## s1 s2 sim1 ## 1 0.5 0.5 7.184881 ## 2 1.5 0.5 7.366762 ## 3 2.5 0.5 7.417718 ## 4 3.5 0.5 7.305573 ## 5 4.5 0.5 7.373427 ## 6 5.5 0.5 7.161203 Il est donc facile de transformer le tableau en une grille de type SpatialPixelsDataframe. Pour cela, on passe par une structure de type SpatialPointDataframe dans un premier temps. champSP &lt;- champ # transformer en un raster coordinates(champSP) &lt;- c(&#39;s1&#39;,&#39;s2&#39;) gridded(champSP) &lt;- TRUE Voici la structure de lobjet de type sp. # structure de l&#39;objet str(champSP) ## Formal class &#39;SpatialPixelsDataFrame&#39; [package &quot;sp&quot;] with 7 slots ## ..@ data :&#39;data.frame&#39;: 10000 obs. of 1 variable: ## .. ..$ sim1: num [1:10000] 7.18 7.37 7.42 7.31 7.37 ... ## ..@ coords.nrs : num(0) ## ..@ grid :Formal class &#39;GridTopology&#39; [package &quot;sp&quot;] with 3 slots ## .. .. ..@ cellcentre.offset: Named num [1:2] 0.5 0.5 ## .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;s1&quot; &quot;s2&quot; ## .. .. ..@ cellsize : Named num [1:2] 1 1 ## .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;s1&quot; &quot;s2&quot; ## .. .. ..@ cells.dim : Named int [1:2] 100 100 ## .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;s1&quot; &quot;s2&quot; ## ..@ grid.index : int [1:10000] 9901 9902 9903 9904 9905 9906 9907 9908 9909 9910 ... ## ..@ coords : num [1:10000, 1:2] 0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 ... ## .. ..- attr(*, &quot;dimnames&quot;)=List of 2 ## .. .. ..$ : NULL ## .. .. ..$ : chr [1:2] &quot;s1&quot; &quot;s2&quot; ## ..@ bbox : num [1:2, 1:2] 0 0 100 100 ## .. ..- attr(*, &quot;dimnames&quot;)=List of 2 ## .. .. ..$ : chr [1:2] &quot;s1&quot; &quot;s2&quot; ## .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot; ## ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot ## .. .. ..@ projargs: chr NA Il est assez simple de faire une carte avec le package tmap tm_shape(champSP) + tm_raster()+ tm_layout(legend.outside = TRUE) ## Warning: The projection of the shape object champSP is not known, while it seems ## to be projected. ## Warning: Current projection of shape champSP unknown and cannot be determined. Figure 2.1: Notre réalité: un champ aléatoire simulé avec un variogramme de type exponentiel Lhistogramme de la propriété ressemble à ceci: ggplot(champ, aes(x=sim1)) + geom_histogram(bins = 50) Figure 2.2: Histogramme de la population "],["SI.html", "Chapter 3 Echantillonnage aléatoire simple 3.1 Définition 3.2 Mise en oeuvre avec un logiciel 3.3 Calcul des estimateurs", " Chapter 3 Echantillonnage aléatoire simple 3.1 Définition Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé échantillonnage aléatoire indépendant (IRS) Deux sous-types : avec remise (SIR) sans remise (SI) Cette distinction nest pas pertinente pour des populations infinies Toutes les combinaisons de \\(n\\) unités de population (tous les échantillons de \\(n\\) unités) ont une probabilité égale dêtre sélectionnés 3.2 Mise en oeuvre avec un logiciel 3.2.1 Excel Voici la procédure 3.2.2 Avec R pour les polutations discrètes Voici comment tirer au hasard des position dans lespace à partir de la liste des pixels. n = 100 #fixer la graine pour les tirages aléatoires set.seed(5601) # Creation des identifiants des lignes id = 1:10000 # ou id = seq( from = 1, to = 10000, by = 1) # tire au hasard n valeurs parmi 10000 MesIds &lt;- sample( x = id , size = n) MesIds &lt;- sort(MesIds) # Les coordonn?es champ[MesIds,1:2] ## s1 s2 ## 55 54.5 0.5 ## 104 3.5 1.5 ## 179 78.5 1.5 ## 398 97.5 3.5 ## 564 63.5 5.5 ## 602 1.5 6.5 ## 627 26.5 6.5 ## 680 79.5 6.5 ## 828 27.5 8.5 ## 869 68.5 8.5 ## 906 5.5 9.5 ## 951 50.5 9.5 ## 1086 85.5 10.5 ## 1107 6.5 11.5 ## 1180 79.5 11.5 ## 1279 78.5 12.5 ## 1309 8.5 13.5 ## 1354 53.5 13.5 ## 1676 75.5 16.5 ## 1681 80.5 16.5 ## 1722 21.5 17.5 ## 1771 70.5 17.5 ## 1873 72.5 18.5 ## 1904 3.5 19.5 ## 1969 68.5 19.5 ## 2219 18.5 22.5 ## 2426 25.5 24.5 ## 2455 54.5 24.5 ## 2849 48.5 28.5 ## 2886 85.5 28.5 ## 2907 6.5 29.5 ## 3126 25.5 31.5 ## 3134 33.5 31.5 ## 3186 85.5 31.5 ## 3273 72.5 32.5 ## 3385 84.5 33.5 ## 3439 38.5 34.5 ## 3503 2.5 35.5 ## 3507 6.5 35.5 ## 3688 87.5 36.5 ## 3716 15.5 37.5 ## 3717 16.5 37.5 ## 3998 97.5 39.5 ## 4034 33.5 40.5 ## 4162 61.5 41.5 ## 4388 87.5 43.5 ## 4413 12.5 44.5 ## 4561 60.5 45.5 ## 4732 31.5 47.5 ## 4791 90.5 47.5 ## 4803 2.5 48.5 ## 4923 22.5 49.5 ## 4961 60.5 49.5 ## 5075 74.5 50.5 ## 5267 66.5 52.5 ## 5296 95.5 52.5 ## 5400 99.5 53.5 ## 5494 93.5 54.5 ## 5691 90.5 56.5 ## 5842 41.5 58.5 ## 5969 68.5 59.5 ## 5985 84.5 59.5 ## 6156 55.5 61.5 ## 6184 83.5 61.5 ## 6264 63.5 62.5 ## 6319 18.5 63.5 ## 6368 67.5 63.5 ## 6591 90.5 65.5 ## 6833 32.5 68.5 ## 7180 79.5 71.5 ## 7205 4.5 72.5 ## 7275 74.5 72.5 ## 7655 54.5 76.5 ## 7686 85.5 76.5 ## 7687 86.5 76.5 ## 7815 14.5 78.5 ## 7828 27.5 78.5 ## 7837 36.5 78.5 ## 7871 70.5 78.5 ## 8003 2.5 80.5 ## 8091 90.5 80.5 ## 8107 6.5 81.5 ## 8110 9.5 81.5 ## 8114 13.5 81.5 ## 8145 44.5 81.5 ## 8173 72.5 81.5 ## 8427 26.5 84.5 ## 8578 77.5 85.5 ## 8725 24.5 87.5 ## 8796 95.5 87.5 ## 8838 37.5 88.5 ## 8900 99.5 88.5 ## 8973 72.5 89.5 ## 9200 99.5 91.5 ## 9233 32.5 92.5 ## 9356 55.5 93.5 ## 9475 74.5 94.5 ## 9642 41.5 96.5 ## 9882 81.5 98.5 ## 9888 87.5 98.5 Il est possible alors dextraire les valeurs de carbone simulée pour les pixels tirés au hasard terrain1 &lt;- champ[ MesIds, &quot;sim1&quot; ] terrain1 ## [1] 3.787593 7.170623 4.517748 5.589748 4.565427 6.336521 4.049022 5.577667 ## [9] 3.713162 4.225770 5.593242 4.239982 5.638317 5.860584 5.711821 5.497942 ## [17] 6.044092 4.458579 4.735737 5.489597 4.594399 5.553660 6.099380 5.702267 ## [25] 6.537367 5.694971 4.694624 5.248670 5.037648 5.242812 5.221360 5.264437 ## [33] 4.784483 5.840797 5.469615 5.857722 3.882786 4.616115 6.204689 5.870410 ## [41] 4.724160 4.707472 6.158010 4.553779 4.974736 5.719054 6.094108 5.834871 ## [49] 5.158347 5.672356 6.690522 5.749796 5.237050 5.922389 4.860998 6.029101 ## [57] 5.406237 6.776609 5.686336 5.295240 5.695276 5.449098 6.962826 4.919653 ## [65] 5.535974 5.794639 5.727957 5.237833 5.217027 5.694664 6.798903 5.535315 ## [73] 5.288701 6.350921 6.602880 6.201846 6.441773 5.369688 5.333607 6.436127 ## [81] 5.995748 5.371798 5.808038 6.434013 5.071711 5.335138 5.642908 6.175720 ## [89] 5.304427 5.244798 4.513166 5.442995 5.346196 5.236982 4.856616 5.302665 ## [97] 5.275403 3.683868 5.953372 5.166673 3.2.3 Avec R pour les populations continues 1 Déterminer les coordonnées minimales et maximales s1 et s2 du domaine (boîte englobante) 2 Tirez deux coordonnées (pseudo-)aléatoires indépendantes \\(s_{1,v}\\) et \\(s_{2,aleat}\\) 3. Utilisez une routine de point dans le polygone pour déterminer si (s_{1,v}\\(,\\)s_{2,aleat}$) tombe dans la zone 4. Répétez les étapes 2 et 3 jusquà ce que n positions soient sélectionnées Le package sp offre la fonction spsample pour effectuer cette procédure à partir de couches SIG. MonEch &lt;- spsample( champSP , n , type = &quot;random&quot;) tm_shape(champSP) + tm_raster()+ tm_shape(MonEch)+ tm_symbols()+ tm_layout(legend.outside = TRUE) ## Warning: The projection of the shape object champSP is not known, while it seems ## to be projected. ## Warning: Current projection of shape champSP unknown and cannot be determined. ## Warning: Current projection of shape MonEch unknown and cannot be determined. 3.3 Calcul des estimateurs Dans cette partie nous explorons les techniques pour calculer les estimateurs des paramètres statistiques à partir des données collectées. 3.3.1 lestimateur de Horvitz-Thompson Lestimateur H-T du total est \\(\\hat t = \\sum{z_i/\\pi_i}\\) Lestimateur H-T de la moyenne est \\(\\hat t = 1/N\\sum_{i=1}^n{z_i/\\pi_i}\\) \\(\\pi\\) est la probabilité quun site déchantillonnage soit inclu dans léchantillon (probabilité dinclusion) \\(z_i/\\pi_i\\) sappelle les valeurs étendues Cette formule fonctionne pour nimporte quel plan déchantillonnage avec \\(\\pi_i\\) connus Pour un SIR, la probabilité quun site soit choisi pour un tirage vaut \\(1/N\\) avec \\(n\\) tirage, elle vaut \\(\\pi_i = n/N\\) Le total peut donc être estimé par $N/n_{i=1}^n{z_i } = N $ 3.3.2 La moyenne pour le fini Avec le plan aléatoire simple, le calcul de la moyenne est très simple # simulation du terrain terrain &lt;- over(MonEch,champSP) mean(terrain$sim1) ## [1] 5.209595 3.3.3 La variance déchantillonnage 3.3.4 lintervalle de confiance "],["stsi.html", "Chapter 4 STSI", " Chapter 4 STSI "],["SY-QUICK.html", "Chapter 5 Echantillonnage systématique", " Chapter 5 Echantillonnage systématique "],["final-words.html", "Chapter 6 Final Words", " Chapter 6 Final Words We have finished a nice book. "],["references.html", "References", " References "]]
