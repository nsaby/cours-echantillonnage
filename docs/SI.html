<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</title>
  <meta name="description" content="Notes de cours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes de cours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  <meta name="github-repo" content="nsaby/cours-echantillonnage" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols" />
  
  <meta name="twitter:description" content="Notes de cours sur les méthodes pour les plans d’échantillonnage statistique dans l’espace" />
  

<meta name="author" content="Nicolas Saby, INRAe Infosol" />


<meta name="date" content="2021-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="stsi.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cours Echantillonnage Sol</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Pourquoi ce cours</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivations"><i class="fa fa-check"></i><b>1.1</b> Motivations</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#définition"><i class="fa fa-check"></i><b>1.2</b> Définition</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contenu"><i class="fa fa-check"></i><b>1.3</b> Contenu</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#objectifs-de-létude"><i class="fa fa-check"></i><b>1.4</b> Objectifs de l’étude</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#lechantillonnage-probabiliste-vs-non-probabiliste"><i class="fa fa-check"></i><b>1.5</b> L’Echantillonnage Probabiliste vs non probabiliste</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#population-discrète-et-population-continue"><i class="fa fa-check"></i><b>1.6</b> Population discrète et population continue</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#plan"><i class="fa fa-check"></i><b>1.7</b> Plan</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#libraries-utilisées"><i class="fa fa-check"></i><b>1.8</b> Libraries utilisées</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Données</a></li>
<li class="chapter" data-level="3" data-path="SI.html"><a href="SI.html"><i class="fa fa-check"></i><b>3</b> Echantillonnage aléatoire simple</a><ul>
<li class="chapter" data-level="3.1" data-path="SI.html"><a href="SI.html#définition-1"><i class="fa fa-check"></i><b>3.1</b> Définition</a></li>
<li class="chapter" data-level="3.2" data-path="SI.html"><a href="SI.html#mise-en-oeuvre-avec-un-logiciel"><i class="fa fa-check"></i><b>3.2</b> Mise en oeuvre avec un logiciel</a><ul>
<li class="chapter" data-level="3.2.1" data-path="SI.html"><a href="SI.html#excel"><i class="fa fa-check"></i><b>3.2.1</b> Excel</a></li>
<li class="chapter" data-level="3.2.2" data-path="SI.html"><a href="SI.html#avec-r-pour-les-polutations-discrètes"><i class="fa fa-check"></i><b>3.2.2</b> Avec <code>R</code> pour les polutations discrètes</a></li>
<li class="chapter" data-level="3.2.3" data-path="SI.html"><a href="SI.html#avec-r-pour-les-populations-continues"><i class="fa fa-check"></i><b>3.2.3</b> Avec <code>R</code> pour les populations continues</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="SI.html"><a href="SI.html#calcul-des-estimateurs"><i class="fa fa-check"></i><b>3.3</b> Calcul des estimateurs</a><ul>
<li class="chapter" data-level="3.3.1" data-path="SI.html"><a href="SI.html#lestimateur-de-horvitz-thompson"><i class="fa fa-check"></i><b>3.3.1</b> l’estimateur de Horvitz-Thompson</a></li>
<li class="chapter" data-level="3.3.2" data-path="SI.html"><a href="SI.html#la-moyenne-pour-la-population-discrète-fini"><i class="fa fa-check"></i><b>3.3.2</b> La moyenne pour la population discrète fini</a></li>
<li class="chapter" data-level="3.3.3" data-path="SI.html"><a href="SI.html#la-variance-spatiale-et-variance-déchantillonnage"><i class="fa fa-check"></i><b>3.3.3</b> La variance spatiale et variance d’échantillonnage</a></li>
<li class="chapter" data-level="3.3.4" data-path="SI.html"><a href="SI.html#linterval-de-confiance"><i class="fa fa-check"></i><b>3.3.4</b> l’interval de confiance</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SI.html"><a href="SI.html#simulations"><i class="fa fa-check"></i><b>3.4</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stsi.html"><a href="stsi.html"><i class="fa fa-check"></i><b>4</b> STSI</a></li>
<li class="chapter" data-level="5" data-path="SY-QUICK.html"><a href="SY-QUICK.html"><i class="fa fa-check"></i><b>5</b> Echantillonnage aléatoire systématique</a><ul>
<li class="chapter" data-level="5.1" data-path="SY-QUICK.html"><a href="SY-QUICK.html#définitions"><i class="fa fa-check"></i><b>5.1</b> Définitions</a></li>
<li class="chapter" data-level="5.2" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-grille"><i class="fa fa-check"></i><b>5.2</b> Exemple de grille</a></li>
<li class="chapter" data-level="5.3" data-path="SY-QUICK.html"><a href="SY-QUICK.html#théorie"><i class="fa fa-check"></i><b>5.3</b> théorie</a></li>
<li class="chapter" data-level="5.4" data-path="SY-QUICK.html"><a href="SY-QUICK.html#exemple-de-mise-en-oeuvre"><i class="fa fa-check"></i><b>5.4</b> Exemple de mise en oeuvre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="CARTO.html"><a href="CARTO.html"><i class="fa fa-check"></i><b>6</b> Echantillonnage pour la cartographie</a><ul>
<li class="chapter" data-level="6.1" data-path="CARTO.html"><a href="CARTO.html#définitions-1"><i class="fa fa-check"></i><b>6.1</b> Définitions</a></li>
<li class="chapter" data-level="6.2" data-path="CARTO.html"><a href="CARTO.html#différents-types-de-plan-disponibles"><i class="fa fa-check"></i><b>6.2</b> Différents types de plan disponibles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SI" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Echantillonnage aléatoire simple</h1>
<div id="définition-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Définition</h2>
<p>Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé “échantillonnage aléatoire indépendant (IRS)”</p>
<ul>
<li><p>Deux sous-types :</p></li>
<li><p>avec remise (SIR)</p></li>
<li><p>sans remise (SI)</p></li>
<li><p>Cette distinction n’est pas pertinente pour des populations infinies</p></li>
<li><p>Toutes les combinaisons de <span class="math inline">\(n\)</span> unités de population (tous les échantillons de <span class="math inline">\(n\)</span> unités) ont une probabilité égale d’être sélectionnés</p></li>
</ul>
</div>
<div id="mise-en-oeuvre-avec-un-logiciel" class="section level2">
<h2><span class="header-section-number">3.2</span> Mise en oeuvre avec un logiciel</h2>
<div id="excel" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Excel</h3>
<p>Voici la procédure</p>
</div>
<div id="avec-r-pour-les-polutations-discrètes" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Avec <code>R</code> pour les polutations discrètes</h3>
<p>Voici comment tirer au hasard des position dans l’espace à partir de la liste des pixels.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="SI.html#cb21-1"></a>n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb21-2"><a href="SI.html#cb21-2"></a></span>
<span id="cb21-3"><a href="SI.html#cb21-3"></a><span class="co">#fixer la graine pour les tirages aléatoires</span></span>
<span id="cb21-4"><a href="SI.html#cb21-4"></a><span class="kw">set.seed</span>(<span class="dv">5602</span>)</span>
<span id="cb21-5"><a href="SI.html#cb21-5"></a></span>
<span id="cb21-6"><a href="SI.html#cb21-6"></a><span class="co"># Creation des identifiants des lignes</span></span>
<span id="cb21-7"><a href="SI.html#cb21-7"></a>id =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10000</span></span>
<span id="cb21-8"><a href="SI.html#cb21-8"></a><span class="co"># ou</span></span>
<span id="cb21-9"><a href="SI.html#cb21-9"></a>id =<span class="st"> </span><span class="kw">seq</span>( <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10000</span>, <span class="dt">by =</span> <span class="dv">1</span>)</span>
<span id="cb21-10"><a href="SI.html#cb21-10"></a><span class="co"># tire au hasard n valeurs parmi 10000</span></span>
<span id="cb21-11"><a href="SI.html#cb21-11"></a>MesIds &lt;-<span class="st"> </span><span class="kw">sample</span>( <span class="dt">x =</span> id  , <span class="dt">size =</span> n)</span>
<span id="cb21-12"><a href="SI.html#cb21-12"></a></span>
<span id="cb21-13"><a href="SI.html#cb21-13"></a>MesIds &lt;-<span class="st"> </span><span class="kw">sort</span>(MesIds)</span>
<span id="cb21-14"><a href="SI.html#cb21-14"></a><span class="co"># Les coordonn?es</span></span>
<span id="cb21-15"><a href="SI.html#cb21-15"></a>champ[ MesIds , <span class="dv">1</span><span class="op">:</span><span class="dv">2</span> ]</span></code></pre></div>
<pre><code>##        s1   s2
## 220  19.5  2.5
## 286  85.5  2.5
## 564  63.5  5.5
## 1631 30.5 16.5
## 1740 39.5 17.5
## 2202  1.5 22.5
## 2630 29.5 26.5
## 3105  4.5 31.5
## 3180 79.5 31.5
## 4063 62.5 40.5
## 5125 24.5 51.5
## 6048 47.5 60.5
## 6209  8.5 62.5
## 6355 54.5 63.5
## 7589 88.5 75.5
## 7666 65.5 76.5
## 7723 22.5 77.5
## 7897 96.5 78.5
## 8220 19.5 82.5
## 9119 18.5 91.5</code></pre>
<p>Il est possible alors d’extraire les valeurs de carbone simulée pour les pixels tirés au hasard</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="SI.html#cb23-1"></a>terrain1 &lt;-<span class="st"> </span>champ[ MesIds, <span class="st">&quot;sim1&quot;</span> ]</span>
<span id="cb23-2"><a href="SI.html#cb23-2"></a>terrain1</span></code></pre></div>
<pre><code>##  [1] 5.088422 5.870447 4.565427 3.839903 4.177815 6.237273 5.100200 5.643163
##  [9] 6.107451 5.163339 5.708381 6.154790 6.040184 6.388020 6.277084 5.526610
## [17] 6.171215 5.415374 6.536455 4.433357</code></pre>
</div>
<div id="avec-r-pour-les-populations-continues" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Avec <code>R</code> pour les populations continues</h3>
<p>1 Déterminer les coordonnées minimales et maximales s1 et s2
du domaine (boîte englobante)</p>
<p>2 Tirez deux coordonnées (pseudo-)aléatoires indépendantes <span class="math inline">\(s_{1,v}\)</span>
et <span class="math inline">\(s_{2,aleat}\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Utilisez une routine de point dans le polygone pour déterminer si (s_{1,v}<span class="math inline">\(,\)</span>s_{2,aleat}$) tombe dans la zone</p></li>
<li><p>Répétez les étapes 2 et 3 jusqu’à ce que n positions soient sélectionnées</p></li>
</ol>
<p>Le package <code>sp</code> offre la fonction <code>spsample</code> pour effectuer cette procédure à partir de couches SIG.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="SI.html#cb25-1"></a>MonEch &lt;-<span class="st"> </span><span class="kw">spsample</span>( <span class="dt">x =</span> champSP ,</span>
<span id="cb25-2"><a href="SI.html#cb25-2"></a>                    <span class="dt">n  =</span> n ,</span>
<span id="cb25-3"><a href="SI.html#cb25-3"></a>                    <span class="dt">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb25-4"><a href="SI.html#cb25-4"></a></span>
<span id="cb25-5"><a href="SI.html#cb25-5"></a></span>
<span id="cb25-6"><a href="SI.html#cb25-6"></a><span class="kw">tm_shape</span>(champSP) <span class="op">+</span></span>
<span id="cb25-7"><a href="SI.html#cb25-7"></a><span class="st">  </span><span class="kw">tm_raster</span>()<span class="op">+</span></span>
<span id="cb25-8"><a href="SI.html#cb25-8"></a><span class="st">  </span><span class="kw">tm_shape</span>(MonEch)<span class="op">+</span></span>
<span id="cb25-9"><a href="SI.html#cb25-9"></a><span class="st">  </span><span class="kw">tm_symbols</span>()<span class="op">+</span></span>
<span id="cb25-10"><a href="SI.html#cb25-10"></a><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: The projection of the shape object champSP is not known, while it seems
## to be projected.</code></pre>
<pre><code>## Warning: Current projection of shape champSP unknown and cannot be determined.</code></pre>
<pre><code>## Warning: Current projection of shape MonEch unknown and cannot be determined.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:SIsample"></span>
<img src="cours-echantillonnage_files/figure-html/SIsample-1.png" alt="Exemple d'échantillonnage aléatoire simple, avec 20 points SI(20)" width="110%" />
<p class="caption">
Figure 3.1: Exemple d’échantillonnage aléatoire simple, avec 20 points SI(20)
</p>
</div>
</div>
</div>
<div id="calcul-des-estimateurs" class="section level2">
<h2><span class="header-section-number">3.3</span> Calcul des estimateurs</h2>
<p>Dans cette partie nous explorons les techniques pour calculer les estimateurs des paramètres statistiques à partir des données collectées.</p>
<div id="lestimateur-de-horvitz-thompson" class="section level3">
<h3><span class="header-section-number">3.3.1</span> l’estimateur de Horvitz-Thompson</h3>
<p>L’estimateur H-T du total est <span class="math inline">\(\hat t = \sum{z_i/\pi_i}\)</span></p>
<p>L’estimateur H-T de la moyenne est <span class="math inline">\(\hat{\overline{t} } = 1/N\sum_{i=1}^n{z_i/\pi_i}\)</span></p>
<p><span class="math inline">\(\pi\)</span> est la probabilité qu’un site d’échantillonnage soit inclu dans l’échantillon (probabilité d’inclusion)</p>
<p><span class="math inline">\(z_i/\pi_i\)</span> s’appelle les valeurs étendues</p>
<p>Cette formule fonctionne pour n’importe quel plan d’échantillonnage avec <span class="math inline">\(\pi_i\)</span> connus</p>
<p>Pour un SIR, la probabilité qu’un site soit choisi pour un tirage vaut <span class="math inline">\(1/N\)</span></p>
<p>avec <span class="math inline">\(n\)</span> tirage, elle vaut <span class="math inline">\(\pi_i = n/N\)</span></p>
<p>Le total peut donc être estimé par <span class="math inline">\(N/n\sum_{i=1}^n{z_i } = N \hat{z}\)</span></p>
</div>
<div id="la-moyenne-pour-la-population-discrète-fini" class="section level3">
<h3><span class="header-section-number">3.3.2</span> La moyenne pour la population discrète fini</h3>
<p>Avec le plan aléatoire simple, le calcul de la moyenne est très simple</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="SI.html#cb29-1"></a><span class="co"># simulation du terrain</span></span>
<span id="cb29-2"><a href="SI.html#cb29-2"></a>terrain2 &lt;-<span class="st"> </span><span class="kw">over</span>(MonEch,champSP)</span>
<span id="cb29-3"><a href="SI.html#cb29-3"></a></span>
<span id="cb29-4"><a href="SI.html#cb29-4"></a>MoyEst &lt;-<span class="st"> </span><span class="kw">mean</span>(terrain2<span class="op">$</span>sim1)</span>
<span id="cb29-5"><a href="SI.html#cb29-5"></a></span>
<span id="cb29-6"><a href="SI.html#cb29-6"></a>MoyEst</span></code></pre></div>
<pre><code>## [1] 4.935534</code></pre>
<p>A comparer avec la moyenne de la population <code>R Moy</code></p>
</div>
<div id="la-variance-spatiale-et-variance-déchantillonnage" class="section level3">
<h3><span class="header-section-number">3.3.3</span> La variance spatiale et variance d’échantillonnage</h3>
<p>Ne confondez pas la variance spatiale et la variance d’échantillonnage !</p>
<ul>
<li>La variance spatiale (variance de population) est une caractéristique de la population</li>
<li>La variance d’échantillonnage est une caractéristique d’une stratégie d’échantillonnage,
c’est-à-dire une combinaison d’un plan d’échantillonnage et d’un estimateur</li>
</ul>
<p>Son estimation dans le cas d’un SIR pour une population dite infinie</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = \frac{\hat{S^2}(z) } {n}\)</span></p>
<p>soit</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = \frac{1} {(n(n-1))} \sum_{i=1}^n (z_i - \hat{ \overline{z} })\)</span></p>
<p>Mais l’estimateur peut être utilisé pour les populations finie</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = (1 - \frac{n}N) \frac{\hat{S^2}(z) } {n}\)</span></p>
<p>avec
<span class="math inline">\((1 - \frac{n}N)\)</span> correspondant à la correction pour les populations finies</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="SI.html#cb31-1"></a><span class="co"># Variance d&#39;échantillonnage de MoyEst</span></span>
<span id="cb31-2"><a href="SI.html#cb31-2"></a>V &lt;-<span class="st"> </span><span class="kw">var</span>(terrain2<span class="op">$</span>sim1) <span class="op">/</span><span class="st"> </span>n</span></code></pre></div>
</div>
<div id="linterval-de-confiance" class="section level3">
<h3><span class="header-section-number">3.3.4</span> l’interval de confiance</h3>
<p>Le calcul de l’interval de confiance sur la moyenne nécessite de faire une hypothèse sur la distribution de <span class="math inline">\(\hat{ \overline{z} }\)</span></p>
<ul>
<li>Pour le un nombre <span class="math inline">\(n\)</span> grand (&gt;30) et si la distribution de la propirété dans l’espace n’est pas trop asymétrique, l’hypothèse de normalité est réaliste</li>
</ul>
<p>L’intervalle de confiance à <span class="math inline">\(100(1-\alpha)\)</span> % est:</p>
<p><span class="math inline">\(\hat{ \overline{z} }\pm u_{1-\alpha/2}.\sqrt{V(\hat{t^l}) }\)</span></p>
<p>où <span class="math display">\[u_{1-\alpha/2}\]</span> est le <span class="math inline">\((1-\alpha/2)\)</span> quantile de la loi normale <span class="math inline">\(u\)</span>.</p>
<p><span class="math inline">\(n\)</span> is the number of sampling observations to compute the mean, eg <span class="math inline">\(n_h*H\)</span>.</p>
<ul>
<li>Pour des <span class="math inline">\(n\)</span> petit (&lt;30), la loi de Student est plus adaptée. on pbtient:</li>
</ul>
<p><span class="math inline">\(\hat{ \overline{z} }\pm t_{1-\alpha/2}^{(n-1)}.\sqrt{V(\hat{t^l}) }\)</span></p>
<p>où <span class="math display">\[t^{(n-1)}_{1-\alpha/2}\]</span> est le <span class="math inline">\((1-\alpha/2)\)</span> quantile de la loi de Student <span class="math inline">\(t\)</span> avec <span class="math inline">\((n-1)\)</span> degrees of freedom. <span class="math inline">\(n\)</span> is the number of sampling observations to compute the mean, eg <span class="math inline">\(n_h*H\)</span>.</p>
<p>Voici comment le mettre en oeuvre dans <code>R</code></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="SI.html#cb32-1"></a><span class="co"># calcul du quantile</span></span>
<span id="cb32-2"><a href="SI.html#cb32-2"></a>zalpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="SI.html#cb32-3"></a><span class="co"># si n est petit &lt; 30</span></span>
<span id="cb32-4"><a href="SI.html#cb32-4"></a>talpha &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dt">p =</span> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>) , <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb32-5"><a href="SI.html#cb32-5"></a></span>
<span id="cb32-6"><a href="SI.html#cb32-6"></a><span class="co"># calcul de l&#39;interval de confiance selon les deux lois</span></span>
<span id="cb32-7"><a href="SI.html#cb32-7"></a>IC &lt;-<span class="st"> </span>zalpha <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V)</span>
<span id="cb32-8"><a href="SI.html#cb32-8"></a>ICT &lt;-<span class="st"> </span>talpha <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(V)</span>
<span id="cb32-9"><a href="SI.html#cb32-9"></a></span>
<span id="cb32-10"><a href="SI.html#cb32-10"></a><span class="kw">c</span>(IC,ICT)</span></code></pre></div>
<pre><code>## [1] 0.3990766 0.4261695</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="SI.html#cb34-1"></a><span class="co"># comme n&lt; 30, on garde ICT</span></span>
<span id="cb34-2"><a href="SI.html#cb34-2"></a><span class="co"># Est-ce que la vraie moyenne est dans l&#39;IC student</span></span>
<span id="cb34-3"><a href="SI.html#cb34-3"></a>Moy <span class="op">&lt;</span><span class="st"> </span>MoyEst <span class="op">+</span><span class="st"> </span>ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="SI.html#cb36-1"></a>Moy <span class="op">&gt;</span><span class="st"> </span>MoyEst <span class="op">-</span><span class="st"> </span>ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="SI.html#cb38-1"></a><span class="dv">2</span> <span class="op">*</span>ICT</span></code></pre></div>
<pre><code>## [1] 0.8523391</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="SI.html#cb40-1"></a><span class="kw">cbind</span>(MoyEst, <span class="dt">ICbas =</span> MoyEst <span class="op">-</span><span class="st"> </span>ICT, <span class="dt">ICHaut =</span>MoyEst <span class="op">+</span><span class="st"> </span>ICT, Moy)</span></code></pre></div>
<pre><code>##        MoyEst    ICbas   ICHaut      Moy
## [1,] 4.935534 4.509364 5.361703 5.298602</code></pre>
</div>
</div>
<div id="simulations" class="section level2">
<h2><span class="header-section-number">3.4</span> Simulations</h2>
<p>Dans cette partie, nous allons tenter d’appréhender l’incertitude de l’estimation de l’indicateur à travers la réalisation de plusieurs échantillonnages simulés de 20 échantillons.</p>
<p>Pour cela, nous tirons au hasard 20 points 10000 fois et nous effectuons la jointure spatiale avec la couche SIG supposée représenter la réalité terrain.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="SI.html#cb42-1"></a>n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb42-2"><a href="SI.html#cb42-2"></a>rep =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb42-3"><a href="SI.html#cb42-3"></a></span>
<span id="cb42-4"><a href="SI.html#cb42-4"></a>N =<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>rep</span>
<span id="cb42-5"><a href="SI.html#cb42-5"></a>MonEch &lt;-<span class="st"> </span><span class="kw">spsample</span>( champSP , N , <span class="dt">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb42-6"><a href="SI.html#cb42-6"></a></span>
<span id="cb42-7"><a href="SI.html#cb42-7"></a><span class="co"># on récupère les valeurs de carbone</span></span>
<span id="cb42-8"><a href="SI.html#cb42-8"></a>terrainSimul &lt;-<span class="st"> </span><span class="kw">over</span>(MonEch,champSP)</span></code></pre></div>
<p>On calcule ensuite, par réplication, les estimations de la moyenne, de la variance d’échantillonnage et de l’intervace de confiance de la moyenne.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="SI.html#cb43-1"></a>terrainSimul<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>rep,n)</span>
<span id="cb43-2"><a href="SI.html#cb43-2"></a></span>
<span id="cb43-3"><a href="SI.html#cb43-3"></a>MesMoys &lt;-<span class="st"> </span><span class="kw">aggregate</span>(terrainSimul<span class="op">$</span>sim1,</span>
<span id="cb43-4"><a href="SI.html#cb43-4"></a>                     <span class="dt">by =</span> <span class="kw">list</span>(terrainSimul<span class="op">$</span>id),</span>
<span id="cb43-5"><a href="SI.html#cb43-5"></a>                     <span class="dt">FUN =</span> mean)</span>
<span id="cb43-6"><a href="SI.html#cb43-6"></a></span>
<span id="cb43-7"><a href="SI.html#cb43-7"></a>MesVarsEch &lt;-<span class="st"> </span><span class="kw">aggregate</span>(terrainSimul<span class="op">$</span>sim1,</span>
<span id="cb43-8"><a href="SI.html#cb43-8"></a>                        <span class="dt">by =</span> <span class="kw">list</span>(terrainSimul<span class="op">$</span>id),</span>
<span id="cb43-9"><a href="SI.html#cb43-9"></a>                        <span class="dt">FUN =</span> var) </span>
<span id="cb43-10"><a href="SI.html#cb43-10"></a></span>
<span id="cb43-11"><a href="SI.html#cb43-11"></a>MesVarsEch<span class="op">$</span>x &lt;-<span class="st"> </span>MesVarsEch<span class="op">$</span>x <span class="op">/</span><span class="st"> </span><span class="dv">20</span></span>
<span id="cb43-12"><a href="SI.html#cb43-12"></a></span>
<span id="cb43-13"><a href="SI.html#cb43-13"></a>MesStats &lt;-<span class="st"> </span><span class="kw">cbind.data.frame</span>(MesMoys,MesVarsEch<span class="op">$</span>x)</span>
<span id="cb43-14"><a href="SI.html#cb43-14"></a><span class="kw">colnames</span>(MesStats) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Group&#39;</span>,<span class="st">&#39;Moy&#39;</span>,<span class="st">&#39;VarEch&#39;</span>)</span>
<span id="cb43-15"><a href="SI.html#cb43-15"></a></span>
<span id="cb43-16"><a href="SI.html#cb43-16"></a>MesStats<span class="op">$</span>UCI &lt;-<span class="st"> </span>MesStats<span class="op">$</span>Moy <span class="op">+</span><span class="st"> </span>talpha <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(MesStats<span class="op">$</span>VarEch)</span>
<span id="cb43-17"><a href="SI.html#cb43-17"></a>MesStats<span class="op">$</span>LCI &lt;-<span class="st"> </span>MesStats<span class="op">$</span>Moy <span class="op">-</span><span class="st"> </span>talpha <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(MesStats<span class="op">$</span>VarEch)</span></code></pre></div>
<p>Pour se rendre compte de l’intervalle de confiance à 95 %, nous représentons sur le graphique suivant pour les 100 premiers tirages, les estimations de la moyenne, et de son intervalle. Nous représentons également la vraie moyenne calculée sur tous les pixels: 5.2986022</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="SI.html#cb44-1"></a><span class="kw">ggplot</span>(MesStats[ MesStats<span class="op">$</span>Group <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>  , ]) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-2"><a href="SI.html#cb44-2"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">size =</span> <span class="fl">0.62</span>, </span>
<span id="cb44-3"><a href="SI.html#cb44-3"></a>                <span class="kw">aes</span>(<span class="dt">x =</span> Group, <span class="dt">ymin =</span> UCI, <span class="dt">ymax =</span> LCI, <span class="dt">y =</span> Moy)) <span class="op">+</span></span>
<span id="cb44-4"><a href="SI.html#cb44-4"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span>  Moy, <span class="dt">slope =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:IC50"></span>
<img src="cours-echantillonnage_files/figure-html/IC50-1.png" alt="Représentation de l'intervalle de confiance à 95 % et de la vraie moyenne en rouge pour chaque simulation" width="110%" />
<p class="caption">
Figure 3.2: Représentation de l’intervalle de confiance à 95 % et de la vraie moyenne en rouge pour chaque simulation
</p>
</div>
<p>Enfin, il est possible de calculer sur l’ensemble des réalisations, le nombre de fois que la vraie moyenne tombe en dehors de l’intervalle de confiance. Ce qui donne :</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="SI.html#cb45-1"></a>MesStats<span class="op">$</span>test &lt;-<span class="st"> </span><span class="kw">ifelse</span>(Moy <span class="op">&gt;</span><span class="st"> </span>MesStats<span class="op">$</span>LCI,</span>
<span id="cb45-2"><a href="SI.html#cb45-2"></a>                        <span class="kw">ifelse</span>(Moy<span class="op">&lt;</span><span class="st"> </span>MesStats<span class="op">$</span>UCI,</span>
<span id="cb45-3"><a href="SI.html#cb45-3"></a>                               <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb45-4"><a href="SI.html#cb45-4"></a>                        <span class="dv">0</span>)</span>
<span id="cb45-5"><a href="SI.html#cb45-5"></a></span>
<span id="cb45-6"><a href="SI.html#cb45-6"></a><span class="dv">100</span><span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(MesStats<span class="op">$</span>test)<span class="op">/</span>rep</span></code></pre></div>
<pre><code>## [1] 94.82</code></pre>
<p>OUI, 95 % comme attendu !</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stsi.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cours-echantillonnage.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
