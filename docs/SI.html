<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</title>
<meta name="author" content="Nicolas Saby, INRAe Infosol, Orléans France">
<meta name="description" content="4.1 Définition Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé “échantillonnage aléatoire indépendant (IRS)” Deux sous-types :...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 4 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols">
<meta property="og:type" content="book">
<meta property="og:description" content="4.1 Définition Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé “échantillonnage aléatoire indépendant (IRS)” Deux sous-types :...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Echantillonnage aléatoire simple | Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols">
<meta name="twitter:description" content="4.1 Définition Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé “échantillonnage aléatoire indépendant (IRS)” Deux sous-types :...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.18/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Avant propos</a></li>
<li><a class="" href="WHY.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="data.html"><span class="header-section-number">3</span> Données</a></li>
<li><a class="active" href="SI.html"><span class="header-section-number">4</span> Echantillonnage aléatoire simple</a></li>
<li><a class="" href="l%C3%A9chantillonnage-al%C3%A9atoire-stratifi%C3%A9.html"><span class="header-section-number">5</span> L’échantillonnage aléatoire stratifié</a></li>
<li><a class="" href="SY-QUICK.html"><span class="header-section-number">6</span> Echantillonnage aléatoire systématique</a></li>
<li><a class="" href="CARTO.html"><span class="header-section-number">7</span> Echantillonnage pour la cartographie</a></li>
<li><a class="" href="Script.html"><span class="header-section-number">8</span> Script final</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="SI" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Echantillonnage aléatoire simple<a class="anchor" aria-label="anchor" href="#SI"><i class="fas fa-link"></i></a>
</h1>
<div id="définition-1" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Définition<a class="anchor" aria-label="anchor" href="#d%C3%A9finition-1"><i class="fas fa-link"></i></a>
</h2>
<p>Les unités sont sélectionnées avec une probabilité égale et indépendamment les unes des autres ; également appelé “échantillonnage aléatoire indépendant (IRS)”</p>
<ul>
<li><p>Deux sous-types :</p></li>
<li><p>avec remise (SIR)</p></li>
<li><p>sans remise (SI)</p></li>
<li><p>Cette distinction n’est pas pertinente pour des populations infinies</p></li>
<li><p>Toutes les combinaisons de <span class="math inline">\(n\)</span> unités de population (tous les échantillons de <span class="math inline">\(n\)</span> unités) ont une probabilité égale d’être sélectionnés</p></li>
</ul>
</div>
<div id="mise-en-oeuvre-avec-un-logiciel" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Mise en oeuvre avec un logiciel<a class="anchor" aria-label="anchor" href="#mise-en-oeuvre-avec-un-logiciel"><i class="fas fa-link"></i></a>
</h2>
<div id="pour-les-polutations-discrètes" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Pour les polutations discrètes<a class="anchor" aria-label="anchor" href="#pour-les-polutations-discr%C3%A8tes"><i class="fas fa-link"></i></a>
</h3>
<div id="excel" class="section level4" number="4.2.1.1">
<h4>
<span class="header-section-number">4.2.1.1</span> Excel<a class="anchor" aria-label="anchor" href="#excel"><i class="fas fa-link"></i></a>
</h4>
<p>Voici la procédure:</p>
<ol style="list-style-type: decimal">
<li>Utiliser la fonction ALEA dans une colonne ajouter au tableau des coordonnées à choisir</li>
<li>Copier coller en valeur le résultat de la fonction ALEA dans une nouvelle colonne</li>
<li>Classer le tableau par ordre croissant selon la colonne créée à l’étape 2</li>
<li>Choisir les n premiers points du tableau</li>
</ol>
</div>
<div id="avec-r" class="section level4" number="4.2.1.2">
<h4>
<span class="header-section-number">4.2.1.2</span> Avec <code>R</code><a class="anchor" aria-label="anchor" href="#avec-r"><i class="fas fa-link"></i></a>
</h4>
<p>Voici comment tirer au hasard des positions dans l’espace à partir de la liste des pixels.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span>

<span class="co">#fixer la graine pour les tirages aléatoires</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">5602</span><span class="op">)</span>

<span class="co"># Creation des identifiants des lignes</span>
<span class="va">id</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>
<span class="co"># ou</span>
<span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span> from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># tire au hasard n valeurs parmi 10000</span>
<span class="va">MesIds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">id</span>  , size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>

<span class="va">MesIds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">MesIds</span><span class="op">)</span>
<span class="co"># Les coordonn?es</span>
<span class="va">champ</span><span class="op">[</span> <span class="va">MesIds</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">2</span> <span class="op">]</span></code></pre></div>
<pre><code>##        s1   s2
## 220  19.5  2.5
## 286  85.5  2.5
## 564  63.5  5.5
## 1631 30.5 16.5
## 1740 39.5 17.5
## 2202  1.5 22.5
## 2630 29.5 26.5
## 3105  4.5 31.5
## 3180 79.5 31.5
## 4063 62.5 40.5
## 5125 24.5 51.5
## 6048 47.5 60.5
## 6209  8.5 62.5
## 6355 54.5 63.5
## 7589 88.5 75.5
## 7666 65.5 76.5
## 7723 22.5 77.5
## 7897 96.5 78.5
## 8220 19.5 82.5
## 9119 18.5 91.5</code></pre>
<p>Il est possible alors d’extraire les valeurs de carbone simulée pour les pixels tirés au hasard</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">terrain1</span> <span class="op">&lt;-</span> <span class="va">champ</span><span class="op">[</span> <span class="va">MesIds</span>, <span class="st">"sim1"</span> <span class="op">]</span>
<span class="va">terrain1</span></code></pre></div>
<pre><code>##  [1] 5.088422 5.870447 4.565427 3.839903 4.177815 6.237273 5.100200 5.643163
##  [9] 6.107451 5.163339 5.708381 6.154790 6.040184 6.388020 6.277084 5.526610
## [17] 6.171215 5.415374 6.536455 4.433357</code></pre>
</div>
</div>
<div id="avec-r-pour-les-populations-continues" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Avec <code>R</code> pour les populations continues<a class="anchor" aria-label="anchor" href="#avec-r-pour-les-populations-continues"><i class="fas fa-link"></i></a>
</h3>
<p>1 Déterminer les coordonnées minimales et maximales s1 et s2
du domaine (boîte englobante)</p>
<p>2 Tirez deux coordonnées (pseudo-)aléatoires indépendantes <span class="math inline">\(s_{1,v}\)</span>
et <span class="math inline">\(s_{2,aleat}\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Utilisez une routine de point dans le polygone pour déterminer si (<span class="math inline">\(s_{1,v}\)</span>,<span class="math inline">\(s_{2,aleat}\)</span>) tombe dans la zone</p></li>
<li><p>Répétez les étapes 2 et 3 jusqu’à ce que n positions soient sélectionnées</p></li>
</ol>
<p>Le package <code>sp</code> offre la fonction <code>spsample</code> pour effectuer cette procédure à partir de couches SIG.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MonEch</span> <span class="op">&lt;-</span> <span class="fu">spsample</span><span class="op">(</span> x <span class="op">=</span> <span class="va">champSP</span> ,
                    n  <span class="op">=</span> <span class="va">n</span> ,
                    type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span>


<span class="va">SI</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">champSP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_raster</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">MonEch</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_symbols</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
<span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">SI</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SIsample"></span>
<img src="cours-echantillonnage_files/figure-html/SIsample-1.png" alt="Exemple d'échantillonnage aléatoire simple, avec 20 points SI(20)" width="110%"><p class="caption">
Figure 4.1: Exemple d’échantillonnage aléatoire simple, avec 20 points SI(20)
</p>
</div>
<p>Le package <code>sf</code> qui va remplacer progressivement <code>sp</code> contient la fonction <code>st_sample</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MonEchSF</span> <span class="op">&lt;-</span> <span class="fu">st_sample</span><span class="op">(</span> x <span class="op">=</span> <span class="fu">as</span><span class="op">(</span><span class="va">champSP</span>,<span class="st">'sf'</span><span class="op">)</span> ,
                    size  <span class="op">=</span> <span class="va">n</span> ,
                    type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span>


<span class="va">SI</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">champSP</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_raster</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">MonEchSF</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_symbols</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
<span class="fu">tm_layout</span><span class="op">(</span>legend.outside <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">SI</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SIsampleSF"></span>
<img src="cours-echantillonnage_files/figure-html/SIsampleSF-1.png" alt="Exemple d'échantillonnage aléatoire simple, avec 20 points SI(20), avec le package sf" width="110%"><p class="caption">
Figure 4.2: Exemple d’échantillonnage aléatoire simple, avec 20 points SI(20), avec le package sf
</p>
</div>
</div>
</div>
<div id="calcul-des-estimateurs" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Calcul des estimateurs<a class="anchor" aria-label="anchor" href="#calcul-des-estimateurs"><i class="fas fa-link"></i></a>
</h2>
<p>Dans cette partie nous explorons les techniques pour calculer les estimateurs des paramètres statistiques à partir des données collectées.</p>
<div id="lestimateur-de-horvitz-thompson" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> l’estimateur de Horvitz-Thompson<a class="anchor" aria-label="anchor" href="#lestimateur-de-horvitz-thompson"><i class="fas fa-link"></i></a>
</h3>
<p>L’estimateur H-T du total est <span class="math inline">\(\hat t = \sum{z_i/\pi_i}\)</span></p>
<p>L’estimateur H-T de la moyenne est <span class="math inline">\(\hat{\overline{t} } = 1/N\sum_{i=1}^n{z_i/\pi_i}\)</span></p>
<p><span class="math inline">\(\pi\)</span> est la probabilité qu’un site d’échantillonnage soit inclu dans l’échantillon (probabilité d’inclusion)</p>
<p><span class="math inline">\(z_i/\pi_i\)</span> s’appelle les valeurs étendues</p>
<p>Cette formule fonctionne pour n’importe quel plan d’échantillonnage avec <span class="math inline">\(\pi_i\)</span> connus</p>
<p>Pour un SIR, la probabilité qu’un site soit choisi pour un tirage vaut <span class="math inline">\(1/N\)</span></p>
<p>avec <span class="math inline">\(n\)</span> tirage, elle vaut <span class="math inline">\(\pi_i = n/N\)</span></p>
<p>Le total peut donc être estimé par <span class="math inline">\(N/n\sum_{i=1}^n{z_i } = N \hat{z}\)</span></p>
</div>
<div id="la-moyenne-pour-la-population-discrète-finie" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> La moyenne pour la population discrète finie<a class="anchor" aria-label="anchor" href="#la-moyenne-pour-la-population-discr%C3%A8te-finie"><i class="fas fa-link"></i></a>
</h3>
<p>Avec le plan aléatoire simple, le calcul de la moyenne est très simple</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># simulation du terrain</span>
<span class="va">terrain2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">over</a></span><span class="op">(</span><span class="va">MonEch</span>,<span class="va">champSP</span><span class="op">)</span>

<span class="va">MoyEst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">terrain2</span><span class="op">$</span><span class="va">sim1</span><span class="op">)</span>

<span class="va">MoyEst</span></code></pre></div>
<pre><code>## [1] 4.935534</code></pre>
<p>A comparer avec la moyenne de la population <span class="math inline">\(5.2986022\)</span></p>
</div>
<div id="la-variance-spatiale-et-variance-déchantillonnage" class="section level3" number="4.3.3">
<h3>
<span class="header-section-number">4.3.3</span> La variance spatiale et variance d’échantillonnage<a class="anchor" aria-label="anchor" href="#la-variance-spatiale-et-variance-d%C3%A9chantillonnage"><i class="fas fa-link"></i></a>
</h3>
<p>Ne confondez pas la variance spatiale et la variance d’échantillonnage !</p>
<ul>
<li>La variance spatiale (variance de population) est une caractéristique de la population</li>
<li>La variance d’échantillonnage est une caractéristique d’une stratégie d’échantillonnage,
c’est-à-dire une combinaison d’un plan d’échantillonnage et d’un estimateur</li>
</ul>
<p>Son estimation dans le cas d’un SIR pour une population dite infinie</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = \frac{\hat{S^2}(z) } {n}\)</span></p>
<p>soit</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = \frac{1} {(n(n-1))} \sum_{i=1}^n (z_i - \hat{ \overline{z} })\)</span></p>
<p>Mais l’estimateur peut être utilisé pour les populations finie</p>
<p><span class="math inline">\(\hat{V}(\hat{ \overline{z} } ) = (1 - \frac{n}N) \frac{\hat{S^2}(z) } {n}\)</span></p>
<p>avec
<span class="math inline">\((1 - \frac{n}N)\)</span> correspondant à la correction pour les populations finies</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Variance d'échantillonnage de MoyEst</span>
<span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">terrain2</span><span class="op">$</span><span class="va">sim1</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></code></pre></div>
</div>
<div id="linterval-de-confiance" class="section level3" number="4.3.4">
<h3>
<span class="header-section-number">4.3.4</span> l’interval de confiance<a class="anchor" aria-label="anchor" href="#linterval-de-confiance"><i class="fas fa-link"></i></a>
</h3>
<p>Le calcul de l’interval de confiance sur la moyenne nécessite de faire une hypothèse sur la distribution de <span class="math inline">\(\hat{ \overline{z} }\)</span></p>
<ul>
<li>Pour le un nombre <span class="math inline">\(n\)</span> grand (&gt;30) et si la distribution de la propirété dans l’espace n’est pas trop asymétrique, l’hypothèse de normalité est réaliste</li>
</ul>
<p>L’intervalle de confiance à <span class="math inline">\(100(1-\alpha)\)</span> % est:</p>
<p><span class="math inline">\(\hat{ \overline{z} }\pm u_{1-\alpha/2}.\sqrt{V(\hat{\overline z}) }\)</span></p>
<p>où <span class="math display">\[u_{1-\alpha/2}\]</span> est le <span class="math inline">\((1-\alpha/2)\)</span> quantile de la loi normale <span class="math inline">\(u\)</span>.</p>
<p><span class="math inline">\(n\)</span> is the number of sampling observations to compute the mean, eg <span class="math inline">\(n_h*H\)</span>.</p>
<ul>
<li>Pour des <span class="math inline">\(n\)</span> petit (&lt;30), la loi de Student est plus adaptée. on obtient:</li>
</ul>
<p><span class="math inline">\(\hat{ \overline{z} }\pm t_{1-\alpha/2}^{(n-1)}.\sqrt{V(\hat{t^l}) }\)</span></p>
<p>où <span class="math display">\[t^{(n-1)}_{1-\alpha/2}\]</span> est le <span class="math inline">\((1-\alpha/2)\)</span> quantile de la loi de Student <span class="math inline">\(t\)</span> avec <span class="math inline">\((n-1)\)</span> degrees of freedom. <span class="math inline">\(n\)</span> is the number of sampling observations to compute the mean, eg <span class="math inline">\(n_h*H\)</span>.</p>
<p>Voici comment le mettre en oeuvre dans <span class="math inline">\(`R`\)</span></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calcul du quantile</span>
<span class="va">zalpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="op">(</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co"># si n est petit &lt; 30</span>
<span class="va">talpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="op">(</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> , df <span class="op">=</span> <span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># calcul de l'interval de confiance selon les deux lois</span>
<span class="va">IC</span> <span class="op">&lt;-</span> <span class="va">zalpha</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>
<span class="va">ICT</span> <span class="op">&lt;-</span> <span class="va">talpha</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">IC</span>,<span class="va">ICT</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3990766 0.4261695</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># comme n&lt; 30, on garde ICT</span>
<span class="co"># Est-ce que la vraie moyenne est dans l'IC student</span>
<span class="va">Moy</span> <span class="op">&lt;</span> <span class="va">MoyEst</span> <span class="op">+</span> <span class="va">ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Moy</span> <span class="op">&gt;</span> <span class="va">MoyEst</span> <span class="op">-</span> <span class="va">ICT</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span><span class="va">ICT</span></code></pre></div>
<pre><code>## [1] 0.8523391</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">MoyEst</span>, ICbas <span class="op">=</span> <span class="va">MoyEst</span> <span class="op">-</span> <span class="va">ICT</span>, ICHaut <span class="op">=</span><span class="va">MoyEst</span> <span class="op">+</span> <span class="va">ICT</span>, <span class="va">Moy</span><span class="op">)</span></code></pre></div>
<pre><code>##        MoyEst    ICbas   ICHaut      Moy
## [1,] 4.935534 4.509364 5.361703 5.298602</code></pre>
</div>
</div>
<div id="simulations-dun-interval-de-confiance" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Simulations d’un interval de confiance<a class="anchor" aria-label="anchor" href="#simulations-dun-interval-de-confiance"><i class="fas fa-link"></i></a>
</h2>
<p>Dans cette partie, nous allons tenter d’appréhender l’incertitude de l’estimation de l’indicateur à travers la réalisation de plusieurs échantillonnages simulés de 20 échantillons.</p>
<p>Pour cela, nous tirons au hasard 20 points 10000 fois et nous effectuons la jointure spatiale avec la couche SIG supposée représenter la réalité terrain.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span>
<span class="va">rep</span> <span class="op">=</span> <span class="fl">10000</span>

<span class="va">N</span> <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="va">rep</span>
<span class="va">MonEch</span> <span class="op">&lt;-</span> <span class="fu">spsample</span><span class="op">(</span> <span class="va">champSP</span> , <span class="va">N</span> , type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span>

<span class="co"># on récupère les valeurs de carbone</span>
<span class="va">terrainSimul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">over</a></span><span class="op">(</span><span class="va">MonEch</span>,<span class="va">champSP</span><span class="op">)</span></code></pre></div>
<p>On calcule ensuite, par réplication, les estimations de la moyenne, de la variance d’échantillonnage et de l’intervace de confiance de la moyenne.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">terrainSimul</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">rep</span>,<span class="va">n</span><span class="op">)</span>

<span class="va">MesMoys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">terrainSimul</span><span class="op">$</span><span class="va">sim1</span>,
                     by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">terrainSimul</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,
                     FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>

<span class="va">MesVarsEch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">terrainSimul</span><span class="op">$</span><span class="va">sim1</span>,
                        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">terrainSimul</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,
                        FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span> 

<span class="va">MesVarsEch</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">MesVarsEch</span><span class="op">$</span><span class="va">x</span> <span class="op">/</span> <span class="fl">20</span>

<span class="va">MesStats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">MesMoys</span>,<span class="va">MesVarsEch</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">MesStats</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Group'</span>,<span class="st">'Moy'</span>,<span class="st">'VarEch'</span><span class="op">)</span>

<span class="va">MesStats</span><span class="op">$</span><span class="va">UCI</span> <span class="op">&lt;-</span> <span class="va">MesStats</span><span class="op">$</span><span class="va">Moy</span> <span class="op">+</span> <span class="va">talpha</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MesStats</span><span class="op">$</span><span class="va">VarEch</span><span class="op">)</span>
<span class="va">MesStats</span><span class="op">$</span><span class="va">LCI</span> <span class="op">&lt;-</span> <span class="va">MesStats</span><span class="op">$</span><span class="va">Moy</span> <span class="op">-</span> <span class="va">talpha</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MesStats</span><span class="op">$</span><span class="va">VarEch</span><span class="op">)</span></code></pre></div>
<p>Pour se rendre compte de l’intervalle de confiance à 95 %, nous représentons sur le graphique suivant pour les 100 premiers tirages, les estimations de la moyenne, et de son intervalle. Nous représentons également la vraie moyenne calculée sur tous les pixels: <span class="math inline">\(5.2986022\)</span></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">MesStats</span><span class="op">[</span> <span class="va">MesStats</span><span class="op">$</span><span class="va">Group</span> <span class="op">%in%</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>  , <span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_pointrange</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.62</span>, 
                <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Group</span>, ymin <span class="op">=</span> <span class="va">UCI</span>, ymax <span class="op">=</span> <span class="va">LCI</span>, y <span class="op">=</span> <span class="va">Moy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span>  <span class="va">Moy</span>, slope <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:IC50"></span>
<img src="cours-echantillonnage_files/figure-html/IC50-1.png" alt="Représentation de l'intervalle de confiance à 95 % et de la vraie moyenne en rouge pour chaque simulation" width="110%"><p class="caption">
Figure 4.3: Représentation de l’intervalle de confiance à 95 % et de la vraie moyenne en rouge pour chaque simulation
</p>
</div>
<p>Enfin, il est possible de calculer sur l’ensemble des réalisations, le nombre de fois que la vraie moyenne tombe en dehors de l’intervalle de confiance. Ce qui donne :</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MesStats</span><span class="op">$</span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Moy</span> <span class="op">&gt;</span> <span class="va">MesStats</span><span class="op">$</span><span class="va">LCI</span>,
                        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Moy</span><span class="op">&lt;</span> <span class="va">MesStats</span><span class="op">$</span><span class="va">UCI</span>,
                               <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,
                        <span class="fl">0</span><span class="op">)</span>

<span class="fl">100</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">MesStats</span><span class="op">$</span><span class="va">test</span><span class="op">)</span><span class="op">/</span><span class="va">rep</span></code></pre></div>
<pre><code>## [1] 94.82</code></pre>
<p>OUI, 95 % comme attendu !</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data.html"><span class="header-section-number">3</span> Données</a></div>
<div class="next"><a href="l%C3%A9chantillonnage-al%C3%A9atoire-stratifi%C3%A9.html"><span class="header-section-number">5</span> L’échantillonnage aléatoire stratifié</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#SI"><span class="header-section-number">4</span> Echantillonnage aléatoire simple</a></li>
<li><a class="nav-link" href="#d%C3%A9finition-1"><span class="header-section-number">4.1</span> Définition</a></li>
<li>
<a class="nav-link" href="#mise-en-oeuvre-avec-un-logiciel"><span class="header-section-number">4.2</span> Mise en oeuvre avec un logiciel</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pour-les-polutations-discr%C3%A8tes"><span class="header-section-number">4.2.1</span> Pour les polutations discrètes</a></li>
<li><a class="nav-link" href="#avec-r-pour-les-populations-continues"><span class="header-section-number">4.2.2</span> Avec R pour les populations continues</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#calcul-des-estimateurs"><span class="header-section-number">4.3</span> Calcul des estimateurs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lestimateur-de-horvitz-thompson"><span class="header-section-number">4.3.1</span> l’estimateur de Horvitz-Thompson</a></li>
<li><a class="nav-link" href="#la-moyenne-pour-la-population-discr%C3%A8te-finie"><span class="header-section-number">4.3.2</span> La moyenne pour la population discrète finie</a></li>
<li><a class="nav-link" href="#la-variance-spatiale-et-variance-d%C3%A9chantillonnage"><span class="header-section-number">4.3.3</span> La variance spatiale et variance d’échantillonnage</a></li>
<li><a class="nav-link" href="#linterval-de-confiance"><span class="header-section-number">4.3.4</span> l’interval de confiance</a></li>
</ul>
</li>
<li><a class="nav-link" href="#simulations-dun-interval-de-confiance"><span class="header-section-number">4.4</span> Simulations d’un interval de confiance</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cours sur les plans d’échantillonnage statistique dans l’espace pour l’étude des sols</strong>" was written by Nicolas Saby, INRAe Infosol, Orléans France. It was last built on 2023-01-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
